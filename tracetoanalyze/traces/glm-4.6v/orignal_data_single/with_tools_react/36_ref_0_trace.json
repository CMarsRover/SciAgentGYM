{
  "id": "36_ref_0",
  "query": "第一部分：等相关高斯模型与 Holm 家族错误率\n1. 设随机向量 (X_1,…,X_n) 服从一元高斯位置模型，协方差为等相关结构：\n   对某给定相关系数 ρ ∈ (0,1]，有\n   - X_i ~ N(μ_i, 1)，1 ≤ i ≤ n；\n   - Corr(X_i, X_j) = ρ（i ≠ j）。\n   又可设存在独立随机变量 U ~ N(0,1) 及独立 Z_i ~ N(μ_i/√(1-ρ), 1)，使\n   - X_i = √(1-ρ) Z_i + √ρ U。\n   对每个假设 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，采用 Holm 步降程序：基于单侧检验统计量 X_i 构造 p 值 p_i = 1 - Φ(X_i)，将 {p_i} 从小到大排序，依次与门槛 {u_k} 比较，其中\n   - u_k = α/(n-k+1)，k = 1,…,n，\n   整体显著性水平 α ∈ (0,1)。令 FWER_Holm(n, α, ρ) 表示在任意真/假原假设配置下的家族第一类错误率上界。\n   假设均值统一有界：μ* := sup_i μ_i < ∞。\n   (1.a) 在上述条件下，说明对于任意固定 α ∈ (0,1) 与 ρ ∈ (0,1]，当 n → ∞ 时，FWER_Holm(n, α, ρ) 的极限行为，并给出严谨论证，要求结论不依赖于具体的真/假原假设配置。结果以符号表达式与极限关系给出。\n\n第二部分：流形谱构造相关结构下的多重检验\n2. 给定 n 个样本点 {x_i}_{i=1}^n ⊂ ℝ^d，带宽 ε > 0，构造权重矩阵 W = (w_{ij})：\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   令 D 为度矩阵，D 为对角矩阵且 d_i = ∑_j w_{ij}。定义随机游走拉普拉斯算子\n   - L_rw = I - D^{-1} W。\n   设其特征分解为 L_rw = U Λ U^T，其中 Λ = diag(λ_1,…,λ_n)，0 = λ_1 ≤ λ_2 ≤ …，U = [u_1,…,u_n] 为对应正交特征向量。选取前 m 个非平凡模态（例如 m 为常数或 m = m(n) 随 n 缓慢增长），给定有界连续函数 g(·)，定义核矩阵\n   - K = ∑_{k=2}^{m+1} g(λ_k) u_k u_k^T。\n   再令协方差矩阵\n   - Σ_new(n) = K + τ^2 I_n，τ^2 > 0。\n   令 Y ~ N(μ, Σ_new(n))，分量记为 Y_1,…,Y_n。检验 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，仍用单侧 p 值 p_i = 1 - Φ(Y_i) 与相同的 Holm 步降程序，记对应家族第一类错误率上界为 FWER_new(n, α)。假设：\n   - 均值统一有界：μ* := sup_i |μ_i| < ∞；\n   - 协方差矩阵谱范数一致有界：sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞；\n   - 协方差矩阵条件数一致有界：sup_n κ(Σ_new(n)) ≤ K_0 < ∞。\n   (2.a) 在上述假设下，说明当 n → ∞ 时，FWER_new(n, α) 的极限行为。要求给出符号形式的极限结论，并给出可用于上界控制的定性或定量论证，说明在谱范数与条件数均一致有界且均值有统一上界时，Holm 家族错误率的渐近趋势。\n\n第三部分：球面样本与随机游走拉普拉斯构造\n3. 在维度 d = 10 的单位球面 S^9 上生成 n = 1000 个样本点，记为 X ∈ ℝ^{1000×10}，其前 10 个样本行向量为 x_1,…,x_{10}（具体坐标视为已知常量）。对这些点采用带宽 ε = 0.1 构造权重\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   由此得到基于前 10 个样本点的度向量 d = (d_1,…,d_{10})，并构造对应的随机游走拉普拉斯子矩阵 L_rw^(10)。\n   (3.a) 写出：\n   - 利用给定样本点与权重 w_{ij} 构造 L_rw^(10) 的明确矩阵公式（包括 D、W、L_rw^(10) 各项）；\n   - 解释度向量分量 d_i 的含义及其与 w_{ij} 的关系；\n   - 说明随机游走拉普拉斯 L_rw^(10) 的特征值范围为何包含在一个固定区间内，并指出该区间。[仅需给出符号论证与区间表达式。]\n\n   (3.b) 假设对完整 n = 1000 的球面样本构造 L_rw，并按第二部分方法构造 Σ_new(1000)。结合第二部分结论，讨论在 n = 1000 以及更大 n 情形下，FWER_new(n, α) 随 n 的变化趋势。指出影响该趋势（特别是随 n 递减速度）的主要符号因素，例如 μ*，谱界 C_Σ，条件数界 K_0，模态数量 m(n) 以及 g(·) 的有界性等。结果以定性与符号关系表述，不需具体数值。\n\n第四部分：带宽选择与谱近似误差上界\n4. 对球面 S^9 上的图拉普拉斯谱估计，在不同样本数 n 下给出了经验最优带宽 ε(n) 及对应的谱近似经验误差与理论误差上界。设理论误差上界具有形式\n   - Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))，\n   其中 Bias(ε) 与 Variance(ε, n) 为非负函数，C > 0 为常数。在 n = 1000、ε = 0.4651471、d = 9 的情况下，给出：\n   - bias_term = 0.4651471；\n   - variance_term = 0.3172382；\n   - exponent = -1.75（为某中间标量参数，可视为已知常量，与本题仅作为背景）；\n   - constant_factor C = 10.0；\n   - 由此可得某具体数值 Bound(1000, 0.4651471)（以预设数值存在，考生无需复述该数值，只需通过符号运算说明其计算方式）。\n\n   (4.a) 假设谱近似误差直接影响协方差矩阵构造，使得实际用于检验的协方差为\n   - Σ_new,approx(n) = Σ_new,true(n) + E_n，\n   其中 ‖E_n‖_op ≤ Bound(n, ε(n))。在 Holm 检验下，讨论在 n = 1000 时，若给定 Bound(1000, ε(1000)) 为一已知常数，对 FWER_new(1000, α) 可能造成的影响。说明在何种一般条件下（例如：协方差到检验统计量分布的映射对谱扰动具某种 Lipschitz 稳健性，p 值分布对协方差变化连续等），可以保证该误差不会改变第二部分的渐近极限结论，只会影响有限样本下 FWER 的具体数值大小。结果以定性与符号不等式形式表述。\n\n   (4.b) 使用给定的 bias_term、variance_term 与常数 C，写出 Bound(1000, 0.4651471) 的计算表达式（不需化为具体数值），并说明当 n 增大，ε(n) 按某缩放条件（例如 ε(n)^{d/2+1} 与 (log n)/n 同阶）变化时，Bound(n, ε(n)) 随 n 的变化趋势（例如是否趋于 0 或有界）。结果以符号表达式与极限形式描述，不要求数值。\n\n第五部分：环面数据的错设建模与 Holm 家族错误率的稳健性\n5. 在三维空间中生成 1000 个三维环面样本点 {z_i}，实际位于半径参数为 (R, r) = (2.0, 0.5) 的环面上。现研究者错误地将这些数据视为球面样本，仍然使用球面构造的图拉普拉斯谱方法构造协方差矩阵 Σ_new^sphere(n)，并据此生成高斯向量并进行 Holm 多重检验，记对应家族错误率为 FWER_misspec(n, α)。\n   (5.a) 定性讨论这种模型错设对 FWER_new(n, α) 控制的潜在影响，主要从以下方面分析：\n        - 局部几何（曲率与维度）差异对权重 w_{ij} 及图结构的影响；\n        - 谱近似误差可能系统性偏大的情形对 Σ_new^sphere(n) 与真实相关结构差异的影响；\n        - 在 μ* 有界且 Σ_new^sphere(n) 的谱范数与条件数仍有统一上界的前提下，FWER_misspec(n, α) 的渐近极限与“正确模型”下的 FWER_correct(n, α) 之间的关系（例如是否仍趋于 0 或至多有一个可控偏移）。\n   要求给出定性说明与符号关系，不需数值。\n\n   (5.b) 提出一个合理的误差度量来刻画球面模型与环面真实模型之间的协方差偏差，例如以算子范数 ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op 或某种距离（如 Wasserstein 距离）记为 ε_spec(n)。在此基础上，说明如何在理论或数值上评估此误差对 Holm FWER 的影响，并给出一个可能的上界形式，例如\n        |FWER_misspec(n, α) - FWER_correct(n, α)| 与 ε_spec(n) 之间的关系，\n   要求给出符号上界形式（含某常数因子），并说明 ε_spec(n) 可以与 Bound(n, ε(n)) 同阶或同数量级。不得给出具体数值。\n\n第六部分：综合总结\n6. 对以上各部分进行总结，回答：\n   (6.a) 第一部分和第二部分中 Holm 家族错误率随 n 渐近趋于某极限（特别是趋于 0）的关键理论原因；\n   (6.b) 球面样本与图拉普拉斯谱如何用于构造协方差矩阵，并与简单等相关模型在依赖结构上的差异进行比较；\n   (6.c) Bound(1000, 0.4651471) 的一般推导形式与计算步骤（以符号表达式为主），以及如何利用给定的 bias_term、variance_term 与 C 进行验证；\n   (6.d) 给出经验误差与对应理论上界之间的关系及其与 n 增大时理论趋势的一致性说明（仅作趋势与相对大小分析，不需数值计算）；\n   (6.e) 在实际流形为环面但使用球面模型进行协方差构造的情况下，多重检验 FWER 控制的稳健性与可能偏差来源，并说明在何种条件下 FWER 控制仍然可靠（例如仍渐近趋于 0 或偏差可控）。\n\n所有结果除非题中已显式给定具体值，均以符号表达式、极限或不等式形式给出，不要求具体数值计算。",
  "query_data": {
    "id": "36_ref_0",
    "original_id": 36,
    "refined_index": 0,
    "question": "第一部分：等相关高斯模型与 Holm 家族错误率\n1. 设随机向量 (X_1,…,X_n) 服从一元高斯位置模型，协方差为等相关结构：\n   对某给定相关系数 ρ ∈ (0,1]，有\n   - X_i ~ N(μ_i, 1)，1 ≤ i ≤ n；\n   - Corr(X_i, X_j) = ρ（i ≠ j）。\n   又可设存在独立随机变量 U ~ N(0,1) 及独立 Z_i ~ N(μ_i/√(1-ρ), 1)，使\n   - X_i = √(1-ρ) Z_i + √ρ U。\n   对每个假设 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，采用 Holm 步降程序：基于单侧检验统计量 X_i 构造 p 值 p_i = 1 - Φ(X_i)，将 {p_i} 从小到大排序，依次与门槛 {u_k} 比较，其中\n   - u_k = α/(n-k+1)，k = 1,…,n，\n   整体显著性水平 α ∈ (0,1)。令 FWER_Holm(n, α, ρ) 表示在任意真/假原假设配置下的家族第一类错误率上界。\n   假设均值统一有界：μ* := sup_i μ_i < ∞。\n   (1.a) 在上述条件下，说明对于任意固定 α ∈ (0,1) 与 ρ ∈ (0,1]，当 n → ∞ 时，FWER_Holm(n, α, ρ) 的极限行为，并给出严谨论证，要求结论不依赖于具体的真/假原假设配置。结果以符号表达式与极限关系给出。\n\n第二部分：流形谱构造相关结构下的多重检验\n2. 给定 n 个样本点 {x_i}_{i=1}^n ⊂ ℝ^d，带宽 ε > 0，构造权重矩阵 W = (w_{ij})：\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   令 D 为度矩阵，D 为对角矩阵且 d_i = ∑_j w_{ij}。定义随机游走拉普拉斯算子\n   - L_rw = I - D^{-1} W。\n   设其特征分解为 L_rw = U Λ U^T，其中 Λ = diag(λ_1,…,λ_n)，0 = λ_1 ≤ λ_2 ≤ …，U = [u_1,…,u_n] 为对应正交特征向量。选取前 m 个非平凡模态（例如 m 为常数或 m = m(n) 随 n 缓慢增长），给定有界连续函数 g(·)，定义核矩阵\n   - K = ∑_{k=2}^{m+1} g(λ_k) u_k u_k^T。\n   再令协方差矩阵\n   - Σ_new(n) = K + τ^2 I_n，τ^2 > 0。\n   令 Y ~ N(μ, Σ_new(n))，分量记为 Y_1,…,Y_n。检验 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，仍用单侧 p 值 p_i = 1 - Φ(Y_i) 与相同的 Holm 步降程序，记对应家族第一类错误率上界为 FWER_new(n, α)。假设：\n   - 均值统一有界：μ* := sup_i |μ_i| < ∞；\n   - 协方差矩阵谱范数一致有界：sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞；\n   - 协方差矩阵条件数一致有界：sup_n κ(Σ_new(n)) ≤ K_0 < ∞。\n   (2.a) 在上述假设下，说明当 n → ∞ 时，FWER_new(n, α) 的极限行为。要求给出符号形式的极限结论，并给出可用于上界控制的定性或定量论证，说明在谱范数与条件数均一致有界且均值有统一上界时，Holm 家族错误率的渐近趋势。\n\n第三部分：球面样本与随机游走拉普拉斯构造\n3. 在维度 d = 10 的单位球面 S^9 上生成 n = 1000 个样本点，记为 X ∈ ℝ^{1000×10}，其前 10 个样本行向量为 x_1,…,x_{10}（具体坐标视为已知常量）。对这些点采用带宽 ε = 0.1 构造权重\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   由此得到基于前 10 个样本点的度向量 d = (d_1,…,d_{10})，并构造对应的随机游走拉普拉斯子矩阵 L_rw^(10)。\n   (3.a) 写出：\n   - 利用给定样本点与权重 w_{ij} 构造 L_rw^(10) 的明确矩阵公式（包括 D、W、L_rw^(10) 各项）；\n   - 解释度向量分量 d_i 的含义及其与 w_{ij} 的关系；\n   - 说明随机游走拉普拉斯 L_rw^(10) 的特征值范围为何包含在一个固定区间内，并指出该区间。[仅需给出符号论证与区间表达式。]\n\n   (3.b) 假设对完整 n = 1000 的球面样本构造 L_rw，并按第二部分方法构造 Σ_new(1000)。结合第二部分结论，讨论在 n = 1000 以及更大 n 情形下，FWER_new(n, α) 随 n 的变化趋势。指出影响该趋势（特别是随 n 递减速度）的主要符号因素，例如 μ*，谱界 C_Σ，条件数界 K_0，模态数量 m(n) 以及 g(·) 的有界性等。结果以定性与符号关系表述，不需具体数值。\n\n第四部分：带宽选择与谱近似误差上界\n4. 对球面 S^9 上的图拉普拉斯谱估计，在不同样本数 n 下给出了经验最优带宽 ε(n) 及对应的谱近似经验误差与理论误差上界。设理论误差上界具有形式\n   - Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))，\n   其中 Bias(ε) 与 Variance(ε, n) 为非负函数，C > 0 为常数。在 n = 1000、ε = 0.4651471、d = 9 的情况下，给出：\n   - bias_term = 0.4651471；\n   - variance_term = 0.3172382；\n   - exponent = -1.75（为某中间标量参数，可视为已知常量，与本题仅作为背景）；\n   - constant_factor C = 10.0；\n   - 由此可得某具体数值 Bound(1000, 0.4651471)（以预设数值存在，考生无需复述该数值，只需通过符号运算说明其计算方式）。\n\n   (4.a) 假设谱近似误差直接影响协方差矩阵构造，使得实际用于检验的协方差为\n   - Σ_new,approx(n) = Σ_new,true(n) + E_n，\n   其中 ‖E_n‖_op ≤ Bound(n, ε(n))。在 Holm 检验下，讨论在 n = 1000 时，若给定 Bound(1000, ε(1000)) 为一已知常数，对 FWER_new(1000, α) 可能造成的影响。说明在何种一般条件下（例如：协方差到检验统计量分布的映射对谱扰动具某种 Lipschitz 稳健性，p 值分布对协方差变化连续等），可以保证该误差不会改变第二部分的渐近极限结论，只会影响有限样本下 FWER 的具体数值大小。结果以定性与符号不等式形式表述。\n\n   (4.b) 使用给定的 bias_term、variance_term 与常数 C，写出 Bound(1000, 0.4651471) 的计算表达式（不需化为具体数值），并说明当 n 增大，ε(n) 按某缩放条件（例如 ε(n)^{d/2+1} 与 (log n)/n 同阶）变化时，Bound(n, ε(n)) 随 n 的变化趋势（例如是否趋于 0 或有界）。结果以符号表达式与极限形式描述，不要求数值。\n\n第五部分：环面数据的错设建模与 Holm 家族错误率的稳健性\n5. 在三维空间中生成 1000 个三维环面样本点 {z_i}，实际位于半径参数为 (R, r) = (2.0, 0.5) 的环面上。现研究者错误地将这些数据视为球面样本，仍然使用球面构造的图拉普拉斯谱方法构造协方差矩阵 Σ_new^sphere(n)，并据此生成高斯向量并进行 Holm 多重检验，记对应家族错误率为 FWER_misspec(n, α)。\n   (5.a) 定性讨论这种模型错设对 FWER_new(n, α) 控制的潜在影响，主要从以下方面分析：\n        - 局部几何（曲率与维度）差异对权重 w_{ij} 及图结构的影响；\n        - 谱近似误差可能系统性偏大的情形对 Σ_new^sphere(n) 与真实相关结构差异的影响；\n        - 在 μ* 有界且 Σ_new^sphere(n) 的谱范数与条件数仍有统一上界的前提下，FWER_misspec(n, α) 的渐近极限与“正确模型”下的 FWER_correct(n, α) 之间的关系（例如是否仍趋于 0 或至多有一个可控偏移）。\n   要求给出定性说明与符号关系，不需数值。\n\n   (5.b) 提出一个合理的误差度量来刻画球面模型与环面真实模型之间的协方差偏差，例如以算子范数 ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op 或某种距离（如 Wasserstein 距离）记为 ε_spec(n)。在此基础上，说明如何在理论或数值上评估此误差对 Holm FWER 的影响，并给出一个可能的上界形式，例如\n        |FWER_misspec(n, α) - FWER_correct(n, α)| 与 ε_spec(n) 之间的关系，\n   要求给出符号上界形式（含某常数因子），并说明 ε_spec(n) 可以与 Bound(n, ε(n)) 同阶或同数量级。不得给出具体数值。\n\n第六部分：综合总结\n6. 对以上各部分进行总结，回答：\n   (6.a) 第一部分和第二部分中 Holm 家族错误率随 n 渐近趋于某极限（特别是趋于 0）的关键理论原因；\n   (6.b) 球面样本与图拉普拉斯谱如何用于构造协方差矩阵，并与简单等相关模型在依赖结构上的差异进行比较；\n   (6.c) Bound(1000, 0.4651471) 的一般推导形式与计算步骤（以符号表达式为主），以及如何利用给定的 bias_term、variance_term 与 C 进行验证；\n   (6.d) 给出经验误差与对应理论上界之间的关系及其与 n 增大时理论趋势的一致性说明（仅作趋势与相对大小分析，不需数值计算）；\n   (6.e) 在实际流形为环面但使用球面模型进行协方差构造的情况下，多重检验 FWER 控制的稳健性与可能偏差来源，并说明在何种条件下 FWER 控制仍然可靠（例如仍渐近趋于 0 或偏差可控）。\n\n所有结果除非题中已显式给定具体值，均以符号表达式、极限或不等式形式给出，不要求具体数值计算。",
    "answer": "{'(1.a)': '在 μ* 有界、ρ ∈ (0,1]、α ∈ (0,1) 固定的条件下，对任意真/假原假设配置有\\nlim_{n→∞} FWER_Holm(n, α, ρ) = 0。\\n要点：\\n- 利用等相关表示 X_i = √(1-ρ) Z_i + √ρ U，将条件于 U 的联合分布化为独立高斯和公共位移；\\n- 在 μ* 有界下，条件于 U 的每个真原假设指标 X_i 的上尾概率在 n→∞ 时仍足够小；\\n- Holm 步降阈值最小阶约为 α/n，因此在任意给定 U 下真原假设的同时小 p 值事件概率随 n 衰减；\\n- 对 U 积分后得到统一上界，进而得出上述极限关系。', '(2.a)': '在假设 sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞、sup_n κ(Σ_new(n)) ≤ K_0 < ∞ 且 μ* 有界时，对任意固定 α ∈ (0,1) 有\\nlim_{n→∞} FWER_new(n, α) = 0。\\n要点：\\n- 谱范数与条件数统一有界意味着各坐标的方差与两两相关系数均受控，不会随 n 爆炸或退化；\\n- 可以找到与独立情形可比的子高斯尾界与联合尾界，从而对真原假设下最小 p 值给出随 n 收敛到 0 的上界；\\n- 利用 Holm 步降阈值的 1/n 级缩小以及均值统一有界的假设，可将家族第一类错误率统一上界压缩到随 n → ∞ 而趋于 0；\\n- 真/假原假设的配置只影响常数因子，不影响极限。', '(3.a)': '构造公式与解释：\\n- 权重矩阵 W = (w_{ij})_{1≤i,j≤10}：\\n  w_{ij} = exp( -‖x_i - x_j‖^2 / ε ), i ≠ j； w_{ii} = 0。\\n- 度矩阵 D 为对角矩阵，(D)_{ii} = d_i，且\\n  d_i = ∑_{j=1}^{10} w_{ij}。\\n- 随机游走拉普拉斯子矩阵\\n  L_rw^(10) = I_{10} - D^{-1} W，\\n  即 (L_rw^(10))_{ij} = δ_{ij} - w_{ij} / d_i。\\n- 度向量分量 d_i 的含义：d_i 是结点 i 与所有其他结点之间权重之和，刻画了以高斯核为边权的加权度；\\n- 光谱范围：矩阵 P := D^{-1} W 为行随机矩阵，谱半径不超过 1，且其所有特征值 λ(P) 满足 |λ(P)| ≤ 1。由于 L_rw^(10) = I_{10} - P，其特征值为 1 - λ(P)；因此 L_rw^(10) 的特征值 λ(L_rw^(10)) 满足\\n  0 ≤ λ(L_rw^(10)) ≤ 2，\\n  因而谱半径位于区间 [0, 2]。', '(3.b)': '对 n = 1000 及更大 n：\\n- 由第二部分假设可视 Σ_new(n) 满足 sup_n ‖Σ_new(n)‖_op ≤ C_Σ、sup_n κ(Σ_new(n)) ≤ K_0，且 μ* 有界；\\n- 依据 (2.a) 的结论形式，可认为 FWER_new(n, α) 随 n 单调下降或至少不增加，并满足\\n  lim_{n→∞} FWER_new(n, α) = 0；\\n- 对于固定 n = 1000，FWER_new(1000, α) 是上述极限行为下的有限样本值，其大小受以下因素主导：\\n  1) μ* 越小，真原假设下统计量越集中在 0 附近，最小 p 值越大，FWER 越小；\\n  2) C_Σ 越小、K_0 越接近 1，则相关结构相对“温和”，不会产生极端联合尾部依赖，从而加速 FWER 的递减；\\n  3) 模态数量 m(n) 较小、g(·) 有界且变化平缓，有利于稳定协方差结构，避免高频噪声放大；\\n- 因此可定性认为，在这些参数受控时，FWER_new(n, α) 随 n 增大递减，且递减速度由 μ*、C_Σ、K_0 及 m(n)、g(·) 的选取共同决定。', '(4.a)': '设 Σ_new,approx(n) = Σ_new,true(n) + E_n 且 ‖E_n‖_op ≤ Bound(n, ε(n))。在 n = 1000 时记 B_1000 := Bound(1000, ε(1000)) 为给定常数。\\n要点：\\n- 在高斯模型下，协方差矩阵的扰动 E_n 的算子范数控制了联合分布在某距离度量（例如 Wasserstein 距离或总变差的上界）中的偏差：存在常数 C_1，使得\\n  dist_law(Y_true, Y_approx) ≤ C_1 ‖E_n‖_op ≤ C_1 B_1000；\\n- 若从协方差到 p 值向量分布的映射在该距离下是 Lipschitz 连续的，则存在常数 C_2，使\\n  dist_law(p_true, p_approx) ≤ C_2 B_1000；\\n- Holm 程序的拒绝事件指标是 p 值向量的可测函数，若其对应概率函数对分布扰动也满足某种连续性（例如概率函数对分布距离 Lipschitz），则存在常数 C_3，使得\\n  |FWER_new,approx(1000, α) - FWER_new,true(1000, α)| ≤ C_3 B_1000；\\n- 对于一般 n，有\\n  |FWER_new,approx(n, α) - FWER_new,true(n, α)| ≤ C_3 Bound(n, ε(n))；\\n- 若 Bound(n, ε(n)) 随 n 有界或趋于 0，则第二部分的极限结论 lim_{n→∞} FWER_new,true(n, α) = 0 仍然成立；近似误差只影响有限 n 下的 FWER 数值大小，而不改变 n → ∞ 时的极限。', '(4.b)': '理论上界的符号计算：\\n- 由给定形式，有\\n  Bound(1000, 0.4651471) = C · (Bias(0.4651471) + Variance(0.4651471, 1000))。\\n- 题中给出 bias_term 与 variance_term 为 Bias(0.4651471) 与 Variance(0.4651471, 1000) 的具体值记为 b 与 v，则\\n  Bound(1000, 0.4651471) = C · (b + v)，\\n  其中 C = 10，b = bias_term，v = variance_term。\\n- 因此计算步骤为：先将 b 与 v 相加，再乘以常数 C，即\\n  Bound(1000, 0.4651471) = 10 · (bias_term + variance_term)。\\n\\n关于 n → ∞ 时的缩放：\\n- 若 ε(n) 按某条件缩放，例如存在常数 c > 0 使\\n  ε(n)^{d/2+1} ≍ (log n)/n，\\n  则通常可以得到 Bias(ε(n)) 与 Variance(ε(n), n) 的相反趋势：\\n  1) Bias(ε(n)) 随 ε(n) → 0 而减小，一般可写为 Bias(ε(n)) = O(ε(n)^β) 对某 β > 0；\\n  2) Variance(ε(n), n) 随 n 增大而下降，一般可写为 Variance(ε(n), n) = O((n ε(n)^{d/2+1})^{-γ}) 对某 γ > 0；\\n- 以上缩放条件通常是通过平衡 Bias 与 Variance 的阶数来确定，使得 Bias(ε(n)) 与 Variance(ε(n), n) 具有相近的衰减速率；\\n- 因此\\n  Bound(n, ε(n)) = C · (Bias(ε(n)) + Variance(ε(n), n))\\n  要么随 n → ∞ 而趋于 0，要么在某些边界情形下保持有界，不会随 n 爆炸；\\n- 这保证了谱近似误差对协方差构造的影响在大样本下是可控的，从而不会破坏第二部分中关于 FWER 渐近行为的结论。', '(5.a)': '定性影响分析：\\n- 局部几何差异：环面与球面在曲率和局部维度结构上不同，导致使用球面几何假设构造的邻接权重 w_{ij} 会系统偏离真实几何诱导的权重，表现为边权分布与连通结构的偏差；\\n- 谱近似误差：由于基础流形不同，球面图拉普拉斯谱与真实环面拉普拉斯谱之间存在结构性差异，会使得 Σ_new^sphere(n) 与真实协方差 Σ_true^torus(n) 存在系统性误差，记为 E_spec(n)；该误差可能不再均值为 0，而是带有几何错设引起的偏向；\\n- 对相关结构的影响：上述误差体现在相关结构上意味着坐标间的真实依赖与模型中的依赖会不同，这会改变检验统计量联合分布与极端事件的概率，从而使 FWER_misspec(n, α) 与 FWER_correct(n, α) 产生偏差；\\n- 渐近行为：若尽管错设存在，但仍有\\n  sup_n ‖Σ_new^sphere(n)‖_op ≤ C_Σ^sphere < ∞，sup_n κ(Σ_new^sphere(n)) ≤ K_0^sphere < ∞，\\n  且 μ* 有界，则可沿用第二部分的思路，对错设模型本身的 FWER_misspec(n, α) 建立与 n 相关的上界，并得到\\n  lim_{n→∞} FWER_misspec(n, α) = 0，\\n  或者在更弱条件下，至少有 limsup_{n→∞} FWER_misspec(n, α) ≤ δ，对某小常数 δ ≥ 0；\\n- 因此，几何错设主要影响有限样本下的 FWER 数值大小和收敛速度，但在协方差谱与条件数受控的前提下，不必然破坏 FWER 渐近趋于 0 的性质。', '(5.b)': \"误差度量与 FWER 偏差上界：\\n- 选取误差度量：可定义\\n  ε_spec(n) := ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op，\\n  或者选用相应高斯分布之间的 Wasserstein 距离 W_2，二者在高斯情形下由协方差差异联系；比如存在常数 C_4，使\\n  W_2( N(μ, Σ_true^torus(n)), N(μ, Σ_new^sphere(n)) ) ≤ C_4 ε_spec(n)。\\n- 分布扰动到 FWER 的影响：若从协方差到 p 值向量分布的映射在所选距离下是 Lipschitz 的，则存在常数 C_5，使\\n  dist_law(p_correct, p_misspec) ≤ C_5 ε_spec(n)；\\n- Holm 程序的 FWER 是 p 值分布下某拒绝事件的概率，因此如果此概率函数对分布距离也具 Lipschitz 性，则存在 C_6，使\\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C_6 ε_spec(n)。\\n- 若进一步将 ε_spec(n) 与上文 Bound(n, ε(n)) 建立关系，例如有\\n  ε_spec(n) ≤ C_7 Bound(n, ε(n))，\\n  则可得到组合上界\\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' Bound(n, ε(n))，\\n  其中 C' = C_6 C_7。\\n- 当 Bound(n, ε(n)) 随 n 有界或趋于 0 时，错设模型与正确模型下 FWER 之间的偏差保持可控，甚至随 n 收缩。\", '(6.a)': 'Holm FWER 渐近趋于 0 的关键原因：\\n- 关键是阈值序列 u_k = α/(n-k+1) 随 n 增大而整体下降，尤其是最小阈值与 1/n 同阶，使得在真原假设下出现极小 p 值的概率可被强力压缩；\\n- 均值统一有界（μ* 有界）确保真原假设下统计量的上尾不会因均值漂移而恶化；\\n- 协方差矩阵谱范数与条件数统一有界，保证依赖结构不会产生随 n 爆炸的集体极端事件概率；\\n- 综上，可对最小 p 值的分布给出随 n 收缩的上界，进而得到 FWER 的统一上界随 n → ∞ 而趋于 0。', '(6.b)': '球面样本与图拉普拉斯谱构造协方差的方式及与等相关模型差异：\\n- 对球面样本 {x_i}，通过高斯核构造权重 W，再由 D 与 L_rw = I - D^{-1} W 得到图拉普拉斯；\\n- 对 L_rw 进行谱分解，选取若干前导特征对 {λ_k, u_k}，通过核 g(λ_k) 线性组合 u_k u_k^T 得到低维谱核 K；\\n- 协方差矩阵设为 Σ_new(n) = K + τ^2 I_n，从而将流形几何（通过图结构与谱）编码到相关结构中；\\n- 与等相关模型相比：\\n  1) 等相关模型中所有非对角相关系数相同，结构高度同质；\\n  2) 图拉普拉斯谱协方差则反映局部邻接关系与几何结构，不同结点间相关性取决于图上的距离与谱模态；\\n  3) 这使得依赖结构更为异质与局部化，但在谱界与条件数受控下，其对 Holm FWER 的渐近影响可与等相关情形类似处理。', '(6.c)': 'Bound(1000, 0.4651471) 的推导与验证：\\n- 给定一般公式 Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))；\\n- 在 n = 1000、ε = 0.4651471、d = 9 时，记 Bias(ε) = bias_term，Variance(ε, n) = variance_term，常数 C 已知；\\n- 则符号上\\n  Bound(1000, 0.4651471) = C · (bias_term + variance_term)；\\n- 验证步骤：\\n  1) 将 bias_term 与 variance_term 相加；\\n  2) 用常数 C 乘上述和，即得到 Bound(1000, 0.4651471)；\\n- 通过该步骤可核对给定数值是否符合上述表达式，确保理论公式与数值实现一致。', '(6.d)': '经验误差与理论上界及其趋势的一致性：\\n- 在各个 n（例如 n = 100, 500, 1000）下的经验误差均小于对应的理论上界 Bound(n, ε(n))，体现了上界的保守性；\\n- 随 n 增大，通过适当缩放 ε(n)，理论上 Bias(ε(n)) 与 Variance(ε(n), n) 合理平衡，使 Bound(n, ε(n)) 随 n 减小或保持有界；\\n- 经验误差的变化趋势通常与 Bound(n, ε(n)) 的趋势类似：\\n  1) 经验误差随着 n 增大可能略有波动，但整体不爆炸；\\n  2) 理论上界一般随 n 增长而逐步减小或趋于某有限常数；\\n- 因此，经验误差与理论上界之间的相对关系以及随 n 的趋势总体上与理论预期一致：理论上界提供一个统一的安全阈值，而实际误差位于此阈值之下并呈随 n 改善的趋势。', '(6.e)': \"球面模型用于环面数据时的稳健性与偏差来源：\\n- 偏差来源：\\n  1) 几何错设导致基于球面假设构造的权重与真实环面结构不匹配，引入系统性谱误差；\\n  2) 该谱误差通过协方差矩阵 Σ_new^sphere(n) 体现为对真实相关结构的偏离；\\n  3) 进一步影响 p 值的联合分布，从而偏移 FWER；\\n- 稳健性条件：\\n  1) 若错设后的协方差矩阵 Σ_new^sphere(n) 在谱范数与条件数上仍有统一上界，且均值 μ* 有界，则可以类比第二部分结果，在错设模型下仍建立\\n     lim_{n→∞} FWER_misspec(n, α) = 0\\n     或 limsup_{n→∞} FWER_misspec(n, α) ≤ δ（δ 小）这样的结论；\\n  2) 若协方差偏差 ε_spec(n) 随 n 有界或趋于 0，则利用 Lipschitz 型上界可以保证\\n     |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' ε_spec(n)，\\n     因而偏差可控；\\n- 综合来看，只要错设后的协方差族不出现高维爆炸或高度退化，且几何错设造成的谱偏差有限，多重检验的 FWER 控制在大样本下仍然可靠，主要风险集中在有限样本中 FWER 的轻微偏高或偏低，需要通过模拟或额外保守修正加以校正。\"}",
    "metadata": {
      "subject": "Statistics",
      "topic": "Statistical Analysis",
      "image_path": null,
      "solution_steps": [],
      "tool_expected": [
        "sample_sphere",
        "visualize_manifold_samples",
        "build_graph_laplacian_from_samples",
        "compute_laplacian_eigenpairs",
        "evaluate_sphere_eigenfunction",
        "compute_sampling_vector",
        "compute_alignment_sign",
        "compute_euclidean_error",
        "theoretical_error_bound",
        "visualize_eigenfunction_comparison",
        "analyze_bandwidth_scaling",
        "visualize_convergence_rate",
        "sample_torus"
      ],
      "golden_answer": [
        {
          "(1.a)": "在 μ* 有界、ρ ∈ (0,1]、α ∈ (0,1) 固定的条件下，对任意真/假原假设配置有\nlim_{n→∞} FWER_Holm(n, α, ρ) = 0。\n要点：\n- 利用等相关表示 X_i = √(1-ρ) Z_i + √ρ U，将条件于 U 的联合分布化为独立高斯和公共位移；\n- 在 μ* 有界下，条件于 U 的每个真原假设指标 X_i 的上尾概率在 n→∞ 时仍足够小；\n- Holm 步降阈值最小阶约为 α/n，因此在任意给定 U 下真原假设的同时小 p 值事件概率随 n 衰减；\n- 对 U 积分后得到统一上界，进而得出上述极限关系。",
          "(2.a)": "在假设 sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞、sup_n κ(Σ_new(n)) ≤ K_0 < ∞ 且 μ* 有界时，对任意固定 α ∈ (0,1) 有\nlim_{n→∞} FWER_new(n, α) = 0。\n要点：\n- 谱范数与条件数统一有界意味着各坐标的方差与两两相关系数均受控，不会随 n 爆炸或退化；\n- 可以找到与独立情形可比的子高斯尾界与联合尾界，从而对真原假设下最小 p 值给出随 n 收敛到 0 的上界；\n- 利用 Holm 步降阈值的 1/n 级缩小以及均值统一有界的假设，可将家族第一类错误率统一上界压缩到随 n → ∞ 而趋于 0；\n- 真/假原假设的配置只影响常数因子，不影响极限。",
          "(3.a)": "构造公式与解释：\n- 权重矩阵 W = (w_{ij})_{1≤i,j≤10}：\n  w_{ij} = exp( -‖x_i - x_j‖^2 / ε ), i ≠ j； w_{ii} = 0。\n- 度矩阵 D 为对角矩阵，(D)_{ii} = d_i，且\n  d_i = ∑_{j=1}^{10} w_{ij}。\n- 随机游走拉普拉斯子矩阵\n  L_rw^(10) = I_{10} - D^{-1} W，\n  即 (L_rw^(10))_{ij} = δ_{ij} - w_{ij} / d_i。\n- 度向量分量 d_i 的含义：d_i 是结点 i 与所有其他结点之间权重之和，刻画了以高斯核为边权的加权度；\n- 光谱范围：矩阵 P := D^{-1} W 为行随机矩阵，谱半径不超过 1，且其所有特征值 λ(P) 满足 |λ(P)| ≤ 1。由于 L_rw^(10) = I_{10} - P，其特征值为 1 - λ(P)；因此 L_rw^(10) 的特征值 λ(L_rw^(10)) 满足\n  0 ≤ λ(L_rw^(10)) ≤ 2，\n  因而谱半径位于区间 [0, 2]。",
          "(3.b)": "对 n = 1000 及更大 n：\n- 由第二部分假设可视 Σ_new(n) 满足 sup_n ‖Σ_new(n)‖_op ≤ C_Σ、sup_n κ(Σ_new(n)) ≤ K_0，且 μ* 有界；\n- 依据 (2.a) 的结论形式，可认为 FWER_new(n, α) 随 n 单调下降或至少不增加，并满足\n  lim_{n→∞} FWER_new(n, α) = 0；\n- 对于固定 n = 1000，FWER_new(1000, α) 是上述极限行为下的有限样本值，其大小受以下因素主导：\n  1) μ* 越小，真原假设下统计量越集中在 0 附近，最小 p 值越大，FWER 越小；\n  2) C_Σ 越小、K_0 越接近 1，则相关结构相对“温和”，不会产生极端联合尾部依赖，从而加速 FWER 的递减；\n  3) 模态数量 m(n) 较小、g(·) 有界且变化平缓，有利于稳定协方差结构，避免高频噪声放大；\n- 因此可定性认为，在这些参数受控时，FWER_new(n, α) 随 n 增大递减，且递减速度由 μ*、C_Σ、K_0 及 m(n)、g(·) 的选取共同决定。",
          "(4.a)": "设 Σ_new,approx(n) = Σ_new,true(n) + E_n 且 ‖E_n‖_op ≤ Bound(n, ε(n))。在 n = 1000 时记 B_1000 := Bound(1000, ε(1000)) 为给定常数。\n要点：\n- 在高斯模型下，协方差矩阵的扰动 E_n 的算子范数控制了联合分布在某距离度量（例如 Wasserstein 距离或总变差的上界）中的偏差：存在常数 C_1，使得\n  dist_law(Y_true, Y_approx) ≤ C_1 ‖E_n‖_op ≤ C_1 B_1000；\n- 若从协方差到 p 值向量分布的映射在该距离下是 Lipschitz 连续的，则存在常数 C_2，使\n  dist_law(p_true, p_approx) ≤ C_2 B_1000；\n- Holm 程序的拒绝事件指标是 p 值向量的可测函数，若其对应概率函数对分布扰动也满足某种连续性（例如概率函数对分布距离 Lipschitz），则存在常数 C_3，使得\n  |FWER_new,approx(1000, α) - FWER_new,true(1000, α)| ≤ C_3 B_1000；\n- 对于一般 n，有\n  |FWER_new,approx(n, α) - FWER_new,true(n, α)| ≤ C_3 Bound(n, ε(n))；\n- 若 Bound(n, ε(n)) 随 n 有界或趋于 0，则第二部分的极限结论 lim_{n→∞} FWER_new,true(n, α) = 0 仍然成立；近似误差只影响有限 n 下的 FWER 数值大小，而不改变 n → ∞ 时的极限。",
          "(4.b)": "理论上界的符号计算：\n- 由给定形式，有\n  Bound(1000, 0.4651471) = C · (Bias(0.4651471) + Variance(0.4651471, 1000))。\n- 题中给出 bias_term 与 variance_term 为 Bias(0.4651471) 与 Variance(0.4651471, 1000) 的具体值记为 b 与 v，则\n  Bound(1000, 0.4651471) = C · (b + v)，\n  其中 C = 10，b = bias_term，v = variance_term。\n- 因此计算步骤为：先将 b 与 v 相加，再乘以常数 C，即\n  Bound(1000, 0.4651471) = 10 · (bias_term + variance_term)。\n\n关于 n → ∞ 时的缩放：\n- 若 ε(n) 按某条件缩放，例如存在常数 c > 0 使\n  ε(n)^{d/2+1} ≍ (log n)/n，\n  则通常可以得到 Bias(ε(n)) 与 Variance(ε(n), n) 的相反趋势：\n  1) Bias(ε(n)) 随 ε(n) → 0 而减小，一般可写为 Bias(ε(n)) = O(ε(n)^β) 对某 β > 0；\n  2) Variance(ε(n), n) 随 n 增大而下降，一般可写为 Variance(ε(n), n) = O((n ε(n)^{d/2+1})^{-γ}) 对某 γ > 0；\n- 以上缩放条件通常是通过平衡 Bias 与 Variance 的阶数来确定，使得 Bias(ε(n)) 与 Variance(ε(n), n) 具有相近的衰减速率；\n- 因此\n  Bound(n, ε(n)) = C · (Bias(ε(n)) + Variance(ε(n), n))\n  要么随 n → ∞ 而趋于 0，要么在某些边界情形下保持有界，不会随 n 爆炸；\n- 这保证了谱近似误差对协方差构造的影响在大样本下是可控的，从而不会破坏第二部分中关于 FWER 渐近行为的结论。",
          "(5.a)": "定性影响分析：\n- 局部几何差异：环面与球面在曲率和局部维度结构上不同，导致使用球面几何假设构造的邻接权重 w_{ij} 会系统偏离真实几何诱导的权重，表现为边权分布与连通结构的偏差；\n- 谱近似误差：由于基础流形不同，球面图拉普拉斯谱与真实环面拉普拉斯谱之间存在结构性差异，会使得 Σ_new^sphere(n) 与真实协方差 Σ_true^torus(n) 存在系统性误差，记为 E_spec(n)；该误差可能不再均值为 0，而是带有几何错设引起的偏向；\n- 对相关结构的影响：上述误差体现在相关结构上意味着坐标间的真实依赖与模型中的依赖会不同，这会改变检验统计量联合分布与极端事件的概率，从而使 FWER_misspec(n, α) 与 FWER_correct(n, α) 产生偏差；\n- 渐近行为：若尽管错设存在，但仍有\n  sup_n ‖Σ_new^sphere(n)‖_op ≤ C_Σ^sphere < ∞，sup_n κ(Σ_new^sphere(n)) ≤ K_0^sphere < ∞，\n  且 μ* 有界，则可沿用第二部分的思路，对错设模型本身的 FWER_misspec(n, α) 建立与 n 相关的上界，并得到\n  lim_{n→∞} FWER_misspec(n, α) = 0，\n  或者在更弱条件下，至少有 limsup_{n→∞} FWER_misspec(n, α) ≤ δ，对某小常数 δ ≥ 0；\n- 因此，几何错设主要影响有限样本下的 FWER 数值大小和收敛速度，但在协方差谱与条件数受控的前提下，不必然破坏 FWER 渐近趋于 0 的性质。",
          "(5.b)": "误差度量与 FWER 偏差上界：\n- 选取误差度量：可定义\n  ε_spec(n) := ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op，\n  或者选用相应高斯分布之间的 Wasserstein 距离 W_2，二者在高斯情形下由协方差差异联系；比如存在常数 C_4，使\n  W_2( N(μ, Σ_true^torus(n)), N(μ, Σ_new^sphere(n)) ) ≤ C_4 ε_spec(n)。\n- 分布扰动到 FWER 的影响：若从协方差到 p 值向量分布的映射在所选距离下是 Lipschitz 的，则存在常数 C_5，使\n  dist_law(p_correct, p_misspec) ≤ C_5 ε_spec(n)；\n- Holm 程序的 FWER 是 p 值分布下某拒绝事件的概率，因此如果此概率函数对分布距离也具 Lipschitz 性，则存在 C_6，使\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C_6 ε_spec(n)。\n- 若进一步将 ε_spec(n) 与上文 Bound(n, ε(n)) 建立关系，例如有\n  ε_spec(n) ≤ C_7 Bound(n, ε(n))，\n  则可得到组合上界\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' Bound(n, ε(n))，\n  其中 C' = C_6 C_7。\n- 当 Bound(n, ε(n)) 随 n 有界或趋于 0 时，错设模型与正确模型下 FWER 之间的偏差保持可控，甚至随 n 收缩。",
          "(6.a)": "Holm FWER 渐近趋于 0 的关键原因：\n- 关键是阈值序列 u_k = α/(n-k+1) 随 n 增大而整体下降，尤其是最小阈值与 1/n 同阶，使得在真原假设下出现极小 p 值的概率可被强力压缩；\n- 均值统一有界（μ* 有界）确保真原假设下统计量的上尾不会因均值漂移而恶化；\n- 协方差矩阵谱范数与条件数统一有界，保证依赖结构不会产生随 n 爆炸的集体极端事件概率；\n- 综上，可对最小 p 值的分布给出随 n 收缩的上界，进而得到 FWER 的统一上界随 n → ∞ 而趋于 0。",
          "(6.b)": "球面样本与图拉普拉斯谱构造协方差的方式及与等相关模型差异：\n- 对球面样本 {x_i}，通过高斯核构造权重 W，再由 D 与 L_rw = I - D^{-1} W 得到图拉普拉斯；\n- 对 L_rw 进行谱分解，选取若干前导特征对 {λ_k, u_k}，通过核 g(λ_k) 线性组合 u_k u_k^T 得到低维谱核 K；\n- 协方差矩阵设为 Σ_new(n) = K + τ^2 I_n，从而将流形几何（通过图结构与谱）编码到相关结构中；\n- 与等相关模型相比：\n  1) 等相关模型中所有非对角相关系数相同，结构高度同质；\n  2) 图拉普拉斯谱协方差则反映局部邻接关系与几何结构，不同结点间相关性取决于图上的距离与谱模态；\n  3) 这使得依赖结构更为异质与局部化，但在谱界与条件数受控下，其对 Holm FWER 的渐近影响可与等相关情形类似处理。",
          "(6.c)": "Bound(1000, 0.4651471) 的推导与验证：\n- 给定一般公式 Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))；\n- 在 n = 1000、ε = 0.4651471、d = 9 时，记 Bias(ε) = bias_term，Variance(ε, n) = variance_term，常数 C 已知；\n- 则符号上\n  Bound(1000, 0.4651471) = C · (bias_term + variance_term)；\n- 验证步骤：\n  1) 将 bias_term 与 variance_term 相加；\n  2) 用常数 C 乘上述和，即得到 Bound(1000, 0.4651471)；\n- 通过该步骤可核对给定数值是否符合上述表达式，确保理论公式与数值实现一致。",
          "(6.d)": "经验误差与理论上界及其趋势的一致性：\n- 在各个 n（例如 n = 100, 500, 1000）下的经验误差均小于对应的理论上界 Bound(n, ε(n))，体现了上界的保守性；\n- 随 n 增大，通过适当缩放 ε(n)，理论上 Bias(ε(n)) 与 Variance(ε(n), n) 合理平衡，使 Bound(n, ε(n)) 随 n 减小或保持有界；\n- 经验误差的变化趋势通常与 Bound(n, ε(n)) 的趋势类似：\n  1) 经验误差随着 n 增大可能略有波动，但整体不爆炸；\n  2) 理论上界一般随 n 增长而逐步减小或趋于某有限常数；\n- 因此，经验误差与理论上界之间的相对关系以及随 n 的趋势总体上与理论预期一致：理论上界提供一个统一的安全阈值，而实际误差位于此阈值之下并呈随 n 改善的趋势。",
          "(6.e)": "球面模型用于环面数据时的稳健性与偏差来源：\n- 偏差来源：\n  1) 几何错设导致基于球面假设构造的权重与真实环面结构不匹配，引入系统性谱误差；\n  2) 该谱误差通过协方差矩阵 Σ_new^sphere(n) 体现为对真实相关结构的偏离；\n  3) 进一步影响 p 值的联合分布，从而偏移 FWER；\n- 稳健性条件：\n  1) 若错设后的协方差矩阵 Σ_new^sphere(n) 在谱范数与条件数上仍有统一上界，且均值 μ* 有界，则可以类比第二部分结果，在错设模型下仍建立\n     lim_{n→∞} FWER_misspec(n, α) = 0\n     或 limsup_{n→∞} FWER_misspec(n, α) ≤ δ（δ 小）这样的结论；\n  2) 若协方差偏差 ε_spec(n) 随 n 有界或趋于 0，则利用 Lipschitz 型上界可以保证\n     |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' ε_spec(n)，\n     因而偏差可控；\n- 综合来看，只要错设后的协方差族不出现高维爆炸或高度退化，且几何错设造成的谱偏差有限，多重检验的 FWER 控制在大样本下仍然可靠，主要风险集中在有限样本中 FWER 的轻微偏高或偏低，需要通过模拟或额外保守修正加以校正。"
        }
      ],
      "original_question_id": "36",
      "test_type": "refined",
      "dataset_key": "merged_questions_augmented",
      "trace_root": "/Users/yangyajie/Desktop/code/Toolkit/tracetoanalyze/traces",
      "_dataset_filename": "refine_merged_single_questions.json"
    },
    "usage_tool_protocol": [
      {
        "type": "function",
        "function": {
          "name": "sample_sphere",
          "description": "从(d-1)维单位球面S^{d-1}上均匀采样n个点。使用标准高斯投影方法进行均匀采样。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "n": {
                "type": "integer",
                "description": "采样点数量"
              },
              "d": {
                "type": "integer",
                "description": "环境维度（球面是(d-1)维的）"
              },
              "seed": {
                "type": "integer",
                "description": "随机种子，用于可重现性"
              }
            },
            "required": [
              "n",
              "d"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py",
          "resolved_file_path": "toolkits/statistics/statistical_analysis/manifold_spectral_convergence_toolkit_claude_7.py",
          "resolved_dir": "toolkits/statistics/statistical_analysis"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "sample_torus",
          "description": "从嵌入在R^3中的2D环面上均匀采样n个点。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "n": {
                "type": "integer",
                "description": "采样点数量"
              },
              "R": {
                "type": "number",
                "description": "主半径（从中心到管中心的距离）"
              },
              "r": {
                "type": "number",
                "description": "次半径（管半径）"
              },
              "seed": {
                "type": "integer",
                "description": "随机种子"
              }
            },
            "required": [
              "n"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "compute_laplacian_eigenpairs",
          "description": "计算随机游走拉普拉斯算子的前K个非平凡特征对。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "L_filepath": {
                "type": "string",
                "description": "拉普拉斯矩阵路径"
              },
              "K": {
                "type": "integer",
                "description": "要计算的特征对数量"
              },
              "degrees": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "度矩阵对角线（用于归一化）"
              }
            },
            "required": [
              "L_filepath",
              "K",
              "degrees"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "evaluate_sphere_eigenfunction",
          "description": "在采样点X处计算S^{d-1}的第k个特征函数。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "X": {
                "type": "array",
                "items": {
                  "type": "array",
                  "items": {
                    "type": "number"
                  }
                },
                "description": "球面上的采样点，形状为(n, d)"
              },
              "k": {
                "type": "integer",
                "description": "特征函数索引"
              },
              "d": {
                "type": "integer",
                "description": "环境维度"
              }
            },
            "required": [
              "X",
              "k",
              "d"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "compute_sampling_vector",
          "description": "计算采样向量φ_k(X) = (1/√(pn)) * (f_k(x_1), ..., f_k(x_n))^T。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "f_values": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "采样点处的特征函数值"
              },
              "n": {
                "type": "integer",
                "description": "采样数量"
              },
              "p": {
                "type": "number",
                "description": "均匀密度（归一化流形默认为1.0）"
              }
            },
            "required": [
              "f_values",
              "n"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "compute_alignment_sign",
          "description": "计算最优符号α ∈ {-1, +1}来对齐v与φ。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "v": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "图特征向量"
              },
              "phi": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "采样向量"
              }
            },
            "required": [
              "v",
              "phi"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "compute_euclidean_error",
          "description": "计算欧几里得误差||v - α*φ||_2。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "v": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "图特征向量"
              },
              "phi": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "采样向量"
              },
              "alpha": {
                "type": "integer",
                "description": "对齐符号（±1）"
              }
            },
            "required": [
              "v",
              "phi",
              "alpha"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "theoretical_error_bound",
          "description": "计算理论误差界限：O(ε + ε^{-d/4 + 1/2} * √(log(n)/n))。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "epsilon": {
                "type": "number",
                "description": "带宽参数"
              },
              "n": {
                "type": "integer",
                "description": "采样数量"
              },
              "d": {
                "type": "integer",
                "description": "流形维度"
              }
            },
            "required": [
              "epsilon",
              "n",
              "d"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "build_graph_laplacian_from_samples",
          "description": "从采样点构建完整的随机游走图拉普拉斯算子。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "X": {
                "type": "array",
                "items": {
                  "type": "array",
                  "items": {
                    "type": "number"
                  }
                },
                "description": "采样点，形状为(n, d)"
              },
              "epsilon": {
                "type": "number",
                "description": "带宽参数"
              }
            },
            "required": [
              "X",
              "epsilon"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "analyze_bandwidth_scaling",
          "description": "分析不同采样大小下误差如何随带宽缩放。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "n_values": {
                "type": "array",
                "items": {
                  "type": "integer"
                },
                "description": "要测试的采样大小"
              },
              "d": {
                "type": "integer",
                "description": "环境维度"
              },
              "k": {
                "type": "integer",
                "description": "特征函数索引"
              },
              "manifold_type": {
                "type": "string",
                "description": "流形类型"
              }
            },
            "required": [
              "n_values",
              "d",
              "k"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "visualize_manifold_samples",
          "description": "可视化流形上的采样点。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "X": {
                "type": "array",
                "items": {
                  "type": "array",
                  "items": {
                    "type": "number"
                  }
                },
                "description": "采样点，形状为(n, d)"
              },
              "manifold_type": {
                "type": "string",
                "description": "流形类型：'sphere'或'torus'"
              },
              "title": {
                "type": "string",
                "description": "图表标题"
              }
            },
            "required": [
              "X",
              "manifold_type"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "visualize_eigenfunction_comparison",
          "description": "可视化图特征向量与采样向量之间的比较。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "v": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "图特征向量"
              },
              "phi": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "采样向量"
              },
              "alpha": {
                "type": "integer",
                "description": "对齐符号"
              },
              "k": {
                "type": "integer",
                "description": "特征函数索引"
              },
              "error": {
                "type": "number",
                "description": "欧几里得误差"
              }
            },
            "required": [
              "v",
              "phi",
              "alpha",
              "k",
              "error"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      },
      {
        "type": "function",
        "function": {
          "name": "visualize_convergence_rate",
          "description": "可视化收敛率作为采样大小的函数。",
          "strict": true,
          "parameters": {
            "type": "object",
            "properties": {
              "n_values": {
                "type": "array",
                "items": {
                  "type": "integer"
                },
                "description": "采样大小"
              },
              "errors": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "经验误差"
              },
              "bounds": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "理论界限"
              },
              "epsilons": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "带宽值"
              },
              "d": {
                "type": "integer",
                "description": "流形维度"
              }
            },
            "required": [
              "n_values",
              "errors",
              "bounds",
              "epsilons",
              "d"
            ]
          }
        },
        "additionalProperties": {
          "function_path": "./tools/manifold_spectral_convergence_toolkit_claude_7.py"
        }
      }
    ],
    "refined_version_data": {
      "refined_question": "第一部分：等相关高斯模型与 Holm 家族错误率\n1. 设随机向量 (X_1,…,X_n) 服从一元高斯位置模型，协方差为等相关结构：\n   对某给定相关系数 ρ ∈ (0,1]，有\n   - X_i ~ N(μ_i, 1)，1 ≤ i ≤ n；\n   - Corr(X_i, X_j) = ρ（i ≠ j）。\n   又可设存在独立随机变量 U ~ N(0,1) 及独立 Z_i ~ N(μ_i/√(1-ρ), 1)，使\n   - X_i = √(1-ρ) Z_i + √ρ U。\n   对每个假设 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，采用 Holm 步降程序：基于单侧检验统计量 X_i 构造 p 值 p_i = 1 - Φ(X_i)，将 {p_i} 从小到大排序，依次与门槛 {u_k} 比较，其中\n   - u_k = α/(n-k+1)，k = 1,…,n，\n   整体显著性水平 α ∈ (0,1)。令 FWER_Holm(n, α, ρ) 表示在任意真/假原假设配置下的家族第一类错误率上界。\n   假设均值统一有界：μ* := sup_i μ_i < ∞。\n   (1.a) 在上述条件下，说明对于任意固定 α ∈ (0,1) 与 ρ ∈ (0,1]，当 n → ∞ 时，FWER_Holm(n, α, ρ) 的极限行为，并给出严谨论证，要求结论不依赖于具体的真/假原假设配置。结果以符号表达式与极限关系给出。\n\n第二部分：流形谱构造相关结构下的多重检验\n2. 给定 n 个样本点 {x_i}_{i=1}^n ⊂ ℝ^d，带宽 ε > 0，构造权重矩阵 W = (w_{ij})：\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   令 D 为度矩阵，D 为对角矩阵且 d_i = ∑_j w_{ij}。定义随机游走拉普拉斯算子\n   - L_rw = I - D^{-1} W。\n   设其特征分解为 L_rw = U Λ U^T，其中 Λ = diag(λ_1,…,λ_n)，0 = λ_1 ≤ λ_2 ≤ …，U = [u_1,…,u_n] 为对应正交特征向量。选取前 m 个非平凡模态（例如 m 为常数或 m = m(n) 随 n 缓慢增长），给定有界连续函数 g(·)，定义核矩阵\n   - K = ∑_{k=2}^{m+1} g(λ_k) u_k u_k^T。\n   再令协方差矩阵\n   - Σ_new(n) = K + τ^2 I_n，τ^2 > 0。\n   令 Y ~ N(μ, Σ_new(n))，分量记为 Y_1,…,Y_n。检验 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，仍用单侧 p 值 p_i = 1 - Φ(Y_i) 与相同的 Holm 步降程序，记对应家族第一类错误率上界为 FWER_new(n, α)。假设：\n   - 均值统一有界：μ* := sup_i |μ_i| < ∞；\n   - 协方差矩阵谱范数一致有界：sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞；\n   - 协方差矩阵条件数一致有界：sup_n κ(Σ_new(n)) ≤ K_0 < ∞。\n   (2.a) 在上述假设下，说明当 n → ∞ 时，FWER_new(n, α) 的极限行为。要求给出符号形式的极限结论，并给出可用于上界控制的定性或定量论证，说明在谱范数与条件数均一致有界且均值有统一上界时，Holm 家族错误率的渐近趋势。\n\n第三部分：球面样本与随机游走拉普拉斯构造\n3. 在维度 d = 10 的单位球面 S^9 上生成 n = 1000 个样本点，记为 X ∈ ℝ^{1000×10}，其前 10 个样本行向量为 x_1,…,x_{10}（具体坐标视为已知常量）。对这些点采用带宽 ε = 0.1 构造权重\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   由此得到基于前 10 个样本点的度向量 d = (d_1,…,d_{10})，并构造对应的随机游走拉普拉斯子矩阵 L_rw^(10)。\n   (3.a) 写出：\n   - 利用给定样本点与权重 w_{ij} 构造 L_rw^(10) 的明确矩阵公式（包括 D、W、L_rw^(10) 各项）；\n   - 解释度向量分量 d_i 的含义及其与 w_{ij} 的关系；\n   - 说明随机游走拉普拉斯 L_rw^(10) 的特征值范围为何包含在一个固定区间内，并指出该区间。[仅需给出符号论证与区间表达式。]\n\n   (3.b) 假设对完整 n = 1000 的球面样本构造 L_rw，并按第二部分方法构造 Σ_new(1000)。结合第二部分结论，讨论在 n = 1000 以及更大 n 情形下，FWER_new(n, α) 随 n 的变化趋势。指出影响该趋势（特别是随 n 递减速度）的主要符号因素，例如 μ*，谱界 C_Σ，条件数界 K_0，模态数量 m(n) 以及 g(·) 的有界性等。结果以定性与符号关系表述，不需具体数值。\n\n第四部分：带宽选择与谱近似误差上界\n4. 对球面 S^9 上的图拉普拉斯谱估计，在不同样本数 n 下给出了经验最优带宽 ε(n) 及对应的谱近似经验误差与理论误差上界。设理论误差上界具有形式\n   - Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))，\n   其中 Bias(ε) 与 Variance(ε, n) 为非负函数，C > 0 为常数。在 n = 1000、ε = 0.4651471、d = 9 的情况下，给出：\n   - bias_term = 0.4651471；\n   - variance_term = 0.3172382；\n   - exponent = -1.75（为某中间标量参数，可视为已知常量，与本题仅作为背景）；\n   - constant_factor C = 10.0；\n   - 由此可得某具体数值 Bound(1000, 0.4651471)（以预设数值存在，考生无需复述该数值，只需通过符号运算说明其计算方式）。\n\n   (4.a) 假设谱近似误差直接影响协方差矩阵构造，使得实际用于检验的协方差为\n   - Σ_new,approx(n) = Σ_new,true(n) + E_n，\n   其中 ‖E_n‖_op ≤ Bound(n, ε(n))。在 Holm 检验下，讨论在 n = 1000 时，若给定 Bound(1000, ε(1000)) 为一已知常数，对 FWER_new(1000, α) 可能造成的影响。说明在何种一般条件下（例如：协方差到检验统计量分布的映射对谱扰动具某种 Lipschitz 稳健性，p 值分布对协方差变化连续等），可以保证该误差不会改变第二部分的渐近极限结论，只会影响有限样本下 FWER 的具体数值大小。结果以定性与符号不等式形式表述。\n\n   (4.b) 使用给定的 bias_term、variance_term 与常数 C，写出 Bound(1000, 0.4651471) 的计算表达式（不需化为具体数值），并说明当 n 增大，ε(n) 按某缩放条件（例如 ε(n)^{d/2+1} 与 (log n)/n 同阶）变化时，Bound(n, ε(n)) 随 n 的变化趋势（例如是否趋于 0 或有界）。结果以符号表达式与极限形式描述，不要求数值。\n\n第五部分：环面数据的错设建模与 Holm 家族错误率的稳健性\n5. 在三维空间中生成 1000 个三维环面样本点 {z_i}，实际位于半径参数为 (R, r) = (2.0, 0.5) 的环面上。现研究者错误地将这些数据视为球面样本，仍然使用球面构造的图拉普拉斯谱方法构造协方差矩阵 Σ_new^sphere(n)，并据此生成高斯向量并进行 Holm 多重检验，记对应家族错误率为 FWER_misspec(n, α)。\n   (5.a) 定性讨论这种模型错设对 FWER_new(n, α) 控制的潜在影响，主要从以下方面分析：\n        - 局部几何（曲率与维度）差异对权重 w_{ij} 及图结构的影响；\n        - 谱近似误差可能系统性偏大的情形对 Σ_new^sphere(n) 与真实相关结构差异的影响；\n        - 在 μ* 有界且 Σ_new^sphere(n) 的谱范数与条件数仍有统一上界的前提下，FWER_misspec(n, α) 的渐近极限与“正确模型”下的 FWER_correct(n, α) 之间的关系（例如是否仍趋于 0 或至多有一个可控偏移）。\n   要求给出定性说明与符号关系，不需数值。\n\n   (5.b) 提出一个合理的误差度量来刻画球面模型与环面真实模型之间的协方差偏差，例如以算子范数 ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op 或某种距离（如 Wasserstein 距离）记为 ε_spec(n)。在此基础上，说明如何在理论或数值上评估此误差对 Holm FWER 的影响，并给出一个可能的上界形式，例如\n        |FWER_misspec(n, α) - FWER_correct(n, α)| 与 ε_spec(n) 之间的关系，\n   要求给出符号上界形式（含某常数因子），并说明 ε_spec(n) 可以与 Bound(n, ε(n)) 同阶或同数量级。不得给出具体数值。\n\n第六部分：综合总结\n6. 对以上各部分进行总结，回答：\n   (6.a) 第一部分和第二部分中 Holm 家族错误率随 n 渐近趋于某极限（特别是趋于 0）的关键理论原因；\n   (6.b) 球面样本与图拉普拉斯谱如何用于构造协方差矩阵，并与简单等相关模型在依赖结构上的差异进行比较；\n   (6.c) Bound(1000, 0.4651471) 的一般推导形式与计算步骤（以符号表达式为主），以及如何利用给定的 bias_term、variance_term 与 C 进行验证；\n   (6.d) 给出经验误差与对应理论上界之间的关系及其与 n 增大时理论趋势的一致性说明（仅作趋势与相对大小分析，不需数值计算）；\n   (6.e) 在实际流形为环面但使用球面模型进行协方差构造的情况下，多重检验 FWER 控制的稳健性与可能偏差来源，并说明在何种条件下 FWER 控制仍然可靠（例如仍渐近趋于 0 或偏差可控）。\n\n所有结果除非题中已显式给定具体值，均以符号表达式、极限或不等式形式给出，不要求具体数值计算。",
      "final_answer": {
        "(1.a)": "在 μ* 有界、ρ ∈ (0,1]、α ∈ (0,1) 固定的条件下，对任意真/假原假设配置有\nlim_{n→∞} FWER_Holm(n, α, ρ) = 0。\n要点：\n- 利用等相关表示 X_i = √(1-ρ) Z_i + √ρ U，将条件于 U 的联合分布化为独立高斯和公共位移；\n- 在 μ* 有界下，条件于 U 的每个真原假设指标 X_i 的上尾概率在 n→∞ 时仍足够小；\n- Holm 步降阈值最小阶约为 α/n，因此在任意给定 U 下真原假设的同时小 p 值事件概率随 n 衰减；\n- 对 U 积分后得到统一上界，进而得出上述极限关系。",
        "(2.a)": "在假设 sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞、sup_n κ(Σ_new(n)) ≤ K_0 < ∞ 且 μ* 有界时，对任意固定 α ∈ (0,1) 有\nlim_{n→∞} FWER_new(n, α) = 0。\n要点：\n- 谱范数与条件数统一有界意味着各坐标的方差与两两相关系数均受控，不会随 n 爆炸或退化；\n- 可以找到与独立情形可比的子高斯尾界与联合尾界，从而对真原假设下最小 p 值给出随 n 收敛到 0 的上界；\n- 利用 Holm 步降阈值的 1/n 级缩小以及均值统一有界的假设，可将家族第一类错误率统一上界压缩到随 n → ∞ 而趋于 0；\n- 真/假原假设的配置只影响常数因子，不影响极限。",
        "(3.a)": "构造公式与解释：\n- 权重矩阵 W = (w_{ij})_{1≤i,j≤10}：\n  w_{ij} = exp( -‖x_i - x_j‖^2 / ε ), i ≠ j； w_{ii} = 0。\n- 度矩阵 D 为对角矩阵，(D)_{ii} = d_i，且\n  d_i = ∑_{j=1}^{10} w_{ij}。\n- 随机游走拉普拉斯子矩阵\n  L_rw^(10) = I_{10} - D^{-1} W，\n  即 (L_rw^(10))_{ij} = δ_{ij} - w_{ij} / d_i。\n- 度向量分量 d_i 的含义：d_i 是结点 i 与所有其他结点之间权重之和，刻画了以高斯核为边权的加权度；\n- 光谱范围：矩阵 P := D^{-1} W 为行随机矩阵，谱半径不超过 1，且其所有特征值 λ(P) 满足 |λ(P)| ≤ 1。由于 L_rw^(10) = I_{10} - P，其特征值为 1 - λ(P)；因此 L_rw^(10) 的特征值 λ(L_rw^(10)) 满足\n  0 ≤ λ(L_rw^(10)) ≤ 2，\n  因而谱半径位于区间 [0, 2]。",
        "(3.b)": "对 n = 1000 及更大 n：\n- 由第二部分假设可视 Σ_new(n) 满足 sup_n ‖Σ_new(n)‖_op ≤ C_Σ、sup_n κ(Σ_new(n)) ≤ K_0，且 μ* 有界；\n- 依据 (2.a) 的结论形式，可认为 FWER_new(n, α) 随 n 单调下降或至少不增加，并满足\n  lim_{n→∞} FWER_new(n, α) = 0；\n- 对于固定 n = 1000，FWER_new(1000, α) 是上述极限行为下的有限样本值，其大小受以下因素主导：\n  1) μ* 越小，真原假设下统计量越集中在 0 附近，最小 p 值越大，FWER 越小；\n  2) C_Σ 越小、K_0 越接近 1，则相关结构相对“温和”，不会产生极端联合尾部依赖，从而加速 FWER 的递减；\n  3) 模态数量 m(n) 较小、g(·) 有界且变化平缓，有利于稳定协方差结构，避免高频噪声放大；\n- 因此可定性认为，在这些参数受控时，FWER_new(n, α) 随 n 增大递减，且递减速度由 μ*、C_Σ、K_0 及 m(n)、g(·) 的选取共同决定。",
        "(4.a)": "设 Σ_new,approx(n) = Σ_new,true(n) + E_n 且 ‖E_n‖_op ≤ Bound(n, ε(n))。在 n = 1000 时记 B_1000 := Bound(1000, ε(1000)) 为给定常数。\n要点：\n- 在高斯模型下，协方差矩阵的扰动 E_n 的算子范数控制了联合分布在某距离度量（例如 Wasserstein 距离或总变差的上界）中的偏差：存在常数 C_1，使得\n  dist_law(Y_true, Y_approx) ≤ C_1 ‖E_n‖_op ≤ C_1 B_1000；\n- 若从协方差到 p 值向量分布的映射在该距离下是 Lipschitz 连续的，则存在常数 C_2，使\n  dist_law(p_true, p_approx) ≤ C_2 B_1000；\n- Holm 程序的拒绝事件指标是 p 值向量的可测函数，若其对应概率函数对分布扰动也满足某种连续性（例如概率函数对分布距离 Lipschitz），则存在常数 C_3，使得\n  |FWER_new,approx(1000, α) - FWER_new,true(1000, α)| ≤ C_3 B_1000；\n- 对于一般 n，有\n  |FWER_new,approx(n, α) - FWER_new,true(n, α)| ≤ C_3 Bound(n, ε(n))；\n- 若 Bound(n, ε(n)) 随 n 有界或趋于 0，则第二部分的极限结论 lim_{n→∞} FWER_new,true(n, α) = 0 仍然成立；近似误差只影响有限 n 下的 FWER 数值大小，而不改变 n → ∞ 时的极限。",
        "(4.b)": "理论上界的符号计算：\n- 由给定形式，有\n  Bound(1000, 0.4651471) = C · (Bias(0.4651471) + Variance(0.4651471, 1000))。\n- 题中给出 bias_term 与 variance_term 为 Bias(0.4651471) 与 Variance(0.4651471, 1000) 的具体值记为 b 与 v，则\n  Bound(1000, 0.4651471) = C · (b + v)，\n  其中 C = 10，b = bias_term，v = variance_term。\n- 因此计算步骤为：先将 b 与 v 相加，再乘以常数 C，即\n  Bound(1000, 0.4651471) = 10 · (bias_term + variance_term)。\n\n关于 n → ∞ 时的缩放：\n- 若 ε(n) 按某条件缩放，例如存在常数 c > 0 使\n  ε(n)^{d/2+1} ≍ (log n)/n，\n  则通常可以得到 Bias(ε(n)) 与 Variance(ε(n), n) 的相反趋势：\n  1) Bias(ε(n)) 随 ε(n) → 0 而减小，一般可写为 Bias(ε(n)) = O(ε(n)^β) 对某 β > 0；\n  2) Variance(ε(n), n) 随 n 增大而下降，一般可写为 Variance(ε(n), n) = O((n ε(n)^{d/2+1})^{-γ}) 对某 γ > 0；\n- 以上缩放条件通常是通过平衡 Bias 与 Variance 的阶数来确定，使得 Bias(ε(n)) 与 Variance(ε(n), n) 具有相近的衰减速率；\n- 因此\n  Bound(n, ε(n)) = C · (Bias(ε(n)) + Variance(ε(n), n))\n  要么随 n → ∞ 而趋于 0，要么在某些边界情形下保持有界，不会随 n 爆炸；\n- 这保证了谱近似误差对协方差构造的影响在大样本下是可控的，从而不会破坏第二部分中关于 FWER 渐近行为的结论。",
        "(5.a)": "定性影响分析：\n- 局部几何差异：环面与球面在曲率和局部维度结构上不同，导致使用球面几何假设构造的邻接权重 w_{ij} 会系统偏离真实几何诱导的权重，表现为边权分布与连通结构的偏差；\n- 谱近似误差：由于基础流形不同，球面图拉普拉斯谱与真实环面拉普拉斯谱之间存在结构性差异，会使得 Σ_new^sphere(n) 与真实协方差 Σ_true^torus(n) 存在系统性误差，记为 E_spec(n)；该误差可能不再均值为 0，而是带有几何错设引起的偏向；\n- 对相关结构的影响：上述误差体现在相关结构上意味着坐标间的真实依赖与模型中的依赖会不同，这会改变检验统计量联合分布与极端事件的概率，从而使 FWER_misspec(n, α) 与 FWER_correct(n, α) 产生偏差；\n- 渐近行为：若尽管错设存在，但仍有\n  sup_n ‖Σ_new^sphere(n)‖_op ≤ C_Σ^sphere < ∞，sup_n κ(Σ_new^sphere(n)) ≤ K_0^sphere < ∞，\n  且 μ* 有界，则可沿用第二部分的思路，对错设模型本身的 FWER_misspec(n, α) 建立与 n 相关的上界，并得到\n  lim_{n→∞} FWER_misspec(n, α) = 0，\n  或者在更弱条件下，至少有 limsup_{n→∞} FWER_misspec(n, α) ≤ δ，对某小常数 δ ≥ 0；\n- 因此，几何错设主要影响有限样本下的 FWER 数值大小和收敛速度，但在协方差谱与条件数受控的前提下，不必然破坏 FWER 渐近趋于 0 的性质。",
        "(5.b)": "误差度量与 FWER 偏差上界：\n- 选取误差度量：可定义\n  ε_spec(n) := ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op，\n  或者选用相应高斯分布之间的 Wasserstein 距离 W_2，二者在高斯情形下由协方差差异联系；比如存在常数 C_4，使\n  W_2( N(μ, Σ_true^torus(n)), N(μ, Σ_new^sphere(n)) ) ≤ C_4 ε_spec(n)。\n- 分布扰动到 FWER 的影响：若从协方差到 p 值向量分布的映射在所选距离下是 Lipschitz 的，则存在常数 C_5，使\n  dist_law(p_correct, p_misspec) ≤ C_5 ε_spec(n)；\n- Holm 程序的 FWER 是 p 值分布下某拒绝事件的概率，因此如果此概率函数对分布距离也具 Lipschitz 性，则存在 C_6，使\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C_6 ε_spec(n)。\n- 若进一步将 ε_spec(n) 与上文 Bound(n, ε(n)) 建立关系，例如有\n  ε_spec(n) ≤ C_7 Bound(n, ε(n))，\n  则可得到组合上界\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' Bound(n, ε(n))，\n  其中 C' = C_6 C_7。\n- 当 Bound(n, ε(n)) 随 n 有界或趋于 0 时，错设模型与正确模型下 FWER 之间的偏差保持可控，甚至随 n 收缩。",
        "(6.a)": "Holm FWER 渐近趋于 0 的关键原因：\n- 关键是阈值序列 u_k = α/(n-k+1) 随 n 增大而整体下降，尤其是最小阈值与 1/n 同阶，使得在真原假设下出现极小 p 值的概率可被强力压缩；\n- 均值统一有界（μ* 有界）确保真原假设下统计量的上尾不会因均值漂移而恶化；\n- 协方差矩阵谱范数与条件数统一有界，保证依赖结构不会产生随 n 爆炸的集体极端事件概率；\n- 综上，可对最小 p 值的分布给出随 n 收缩的上界，进而得到 FWER 的统一上界随 n → ∞ 而趋于 0。",
        "(6.b)": "球面样本与图拉普拉斯谱构造协方差的方式及与等相关模型差异：\n- 对球面样本 {x_i}，通过高斯核构造权重 W，再由 D 与 L_rw = I - D^{-1} W 得到图拉普拉斯；\n- 对 L_rw 进行谱分解，选取若干前导特征对 {λ_k, u_k}，通过核 g(λ_k) 线性组合 u_k u_k^T 得到低维谱核 K；\n- 协方差矩阵设为 Σ_new(n) = K + τ^2 I_n，从而将流形几何（通过图结构与谱）编码到相关结构中；\n- 与等相关模型相比：\n  1) 等相关模型中所有非对角相关系数相同，结构高度同质；\n  2) 图拉普拉斯谱协方差则反映局部邻接关系与几何结构，不同结点间相关性取决于图上的距离与谱模态；\n  3) 这使得依赖结构更为异质与局部化，但在谱界与条件数受控下，其对 Holm FWER 的渐近影响可与等相关情形类似处理。",
        "(6.c)": "Bound(1000, 0.4651471) 的推导与验证：\n- 给定一般公式 Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))；\n- 在 n = 1000、ε = 0.4651471、d = 9 时，记 Bias(ε) = bias_term，Variance(ε, n) = variance_term，常数 C 已知；\n- 则符号上\n  Bound(1000, 0.4651471) = C · (bias_term + variance_term)；\n- 验证步骤：\n  1) 将 bias_term 与 variance_term 相加；\n  2) 用常数 C 乘上述和，即得到 Bound(1000, 0.4651471)；\n- 通过该步骤可核对给定数值是否符合上述表达式，确保理论公式与数值实现一致。",
        "(6.d)": "经验误差与理论上界及其趋势的一致性：\n- 在各个 n（例如 n = 100, 500, 1000）下的经验误差均小于对应的理论上界 Bound(n, ε(n))，体现了上界的保守性；\n- 随 n 增大，通过适当缩放 ε(n)，理论上 Bias(ε(n)) 与 Variance(ε(n), n) 合理平衡，使 Bound(n, ε(n)) 随 n 减小或保持有界；\n- 经验误差的变化趋势通常与 Bound(n, ε(n)) 的趋势类似：\n  1) 经验误差随着 n 增大可能略有波动，但整体不爆炸；\n  2) 理论上界一般随 n 增长而逐步减小或趋于某有限常数；\n- 因此，经验误差与理论上界之间的相对关系以及随 n 的趋势总体上与理论预期一致：理论上界提供一个统一的安全阈值，而实际误差位于此阈值之下并呈随 n 改善的趋势。",
        "(6.e)": "球面模型用于环面数据时的稳健性与偏差来源：\n- 偏差来源：\n  1) 几何错设导致基于球面假设构造的权重与真实环面结构不匹配，引入系统性谱误差；\n  2) 该谱误差通过协方差矩阵 Σ_new^sphere(n) 体现为对真实相关结构的偏离；\n  3) 进一步影响 p 值的联合分布，从而偏移 FWER；\n- 稳健性条件：\n  1) 若错设后的协方差矩阵 Σ_new^sphere(n) 在谱范数与条件数上仍有统一上界，且均值 μ* 有界，则可以类比第二部分结果，在错设模型下仍建立\n     lim_{n→∞} FWER_misspec(n, α) = 0\n     或 limsup_{n→∞} FWER_misspec(n, α) ≤ δ（δ 小）这样的结论；\n  2) 若协方差偏差 ε_spec(n) 随 n 有界或趋于 0，则利用 Lipschitz 型上界可以保证\n     |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' ε_spec(n)，\n     因而偏差可控；\n- 综合来看，只要错设后的协方差族不出现高维爆炸或高度退化，且几何错设造成的谱偏差有限，多重检验的 FWER 控制在大样本下仍然可靠，主要风险集中在有限样本中 FWER 的轻微偏高或偏低，需要通过模拟或额外保守修正加以校正。"
      }
    },
    "metadata_summary": {
      "subject": "Statistics",
      "topic": "Statistical Analysis",
      "test_type": "refined",
      "original_question_id": "36",
      "subject_topic_key": "Statistics::Statistical Analysis"
    }
  },
  "model": "glm-4.6v",
  "use_tools": true,
  "mode": "tool_mode",
  "rounds": 1,
  "messages": [
    {
      "role": "system",
      "content": "你是一个顶尖的 AI 科学助手，你的任务是解决来自物理、化学、生物等领域的复杂、多模态、多步骤问题。\n\n# 任务指令：两阶段方法\n\n你必须严格遵循以下两个阶段来回答问题：\n\n**阶段 1: 规划 (Planning)**\n在开始执行任何操作之前，你必须首先生成一个高阶的、分步骤的“计划”。这个计划应该概述你打算如何分解问题、使用哪些工具、以及工具之间的依赖关系。\n\n**阶段 2: 执行 (Execution)**\n在提交计划后，你将开始逐一执行。你必须严格遵循以下的 \"ReAct\" 格式 (Thought, Action, Observation)，直到你得出最终答案。\n\n---\n\n**输出格式规范**\n\n**[阶段 1: 规划]**\nPlan:\n\n1. [你的计划步骤 1，例如：分析输入图像中的分子结构]\n2. [你的计划步骤 2，例如：使用 `analyze_molecule` 工具获取 SMILES]\n3. [你的计划步骤 3，例如：将 SMILES 传入 `calculate_properties` 工具]\n4. ...\n5. [你的计划步骤 N，例如：总结所有属性并回答问题]\n\n**[阶段 2: 执行]**\nThought: [描述你当前的思考，你正处于计划的第几步，以及你为什么需要调用这个特定的工具。]\nAction: 请你在这一步发出工具调用\n\n[在你提交 Action 后，你将收到一个 Observation]\n\nObservation: [这里将由评测系统插入工具的返回结果]\n\n[然后你重复这个循环]\n\nThought: [基于上一步的 Observation，你的新思考。]\nAction: 请你在这一步发出工具调用\n\n...\n[当你收集到所有信息并准备好回答时]\n\nThought: [我已收集到所有必要信息，现在可以生成最终答案了。]\nFinal Answer: [这里是对原始问题的最终、完整回答。]"
    },
    {
      "role": "user",
      "content": "第一部分：等相关高斯模型与 Holm 家族错误率\n1. 设随机向量 (X_1,…,X_n) 服从一元高斯位置模型，协方差为等相关结构：\n   对某给定相关系数 ρ ∈ (0,1]，有\n   - X_i ~ N(μ_i, 1)，1 ≤ i ≤ n；\n   - Corr(X_i, X_j) = ρ（i ≠ j）。\n   又可设存在独立随机变量 U ~ N(0,1) 及独立 Z_i ~ N(μ_i/√(1-ρ), 1)，使\n   - X_i = √(1-ρ) Z_i + √ρ U。\n   对每个假设 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，采用 Holm 步降程序：基于单侧检验统计量 X_i 构造 p 值 p_i = 1 - Φ(X_i)，将 {p_i} 从小到大排序，依次与门槛 {u_k} 比较，其中\n   - u_k = α/(n-k+1)，k = 1,…,n，\n   整体显著性水平 α ∈ (0,1)。令 FWER_Holm(n, α, ρ) 表示在任意真/假原假设配置下的家族第一类错误率上界。\n   假设均值统一有界：μ* := sup_i μ_i < ∞。\n   (1.a) 在上述条件下，说明对于任意固定 α ∈ (0,1) 与 ρ ∈ (0,1]，当 n → ∞ 时，FWER_Holm(n, α, ρ) 的极限行为，并给出严谨论证，要求结论不依赖于具体的真/假原假设配置。结果以符号表达式与极限关系给出。\n\n第二部分：流形谱构造相关结构下的多重检验\n2. 给定 n 个样本点 {x_i}_{i=1}^n ⊂ ℝ^d，带宽 ε > 0，构造权重矩阵 W = (w_{ij})：\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   令 D 为度矩阵，D 为对角矩阵且 d_i = ∑_j w_{ij}。定义随机游走拉普拉斯算子\n   - L_rw = I - D^{-1} W。\n   设其特征分解为 L_rw = U Λ U^T，其中 Λ = diag(λ_1,…,λ_n)，0 = λ_1 ≤ λ_2 ≤ …，U = [u_1,…,u_n] 为对应正交特征向量。选取前 m 个非平凡模态（例如 m 为常数或 m = m(n) 随 n 缓慢增长），给定有界连续函数 g(·)，定义核矩阵\n   - K = ∑_{k=2}^{m+1} g(λ_k) u_k u_k^T。\n   再令协方差矩阵\n   - Σ_new(n) = K + τ^2 I_n，τ^2 > 0。\n   令 Y ~ N(μ, Σ_new(n))，分量记为 Y_1,…,Y_n。检验 H_{0i}: μ_i = 0 与 H_{1i}: μ_i > 0，仍用单侧 p 值 p_i = 1 - Φ(Y_i) 与相同的 Holm 步降程序，记对应家族第一类错误率上界为 FWER_new(n, α)。假设：\n   - 均值统一有界：μ* := sup_i |μ_i| < ∞；\n   - 协方差矩阵谱范数一致有界：sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞；\n   - 协方差矩阵条件数一致有界：sup_n κ(Σ_new(n)) ≤ K_0 < ∞。\n   (2.a) 在上述假设下，说明当 n → ∞ 时，FWER_new(n, α) 的极限行为。要求给出符号形式的极限结论，并给出可用于上界控制的定性或定量论证，说明在谱范数与条件数均一致有界且均值有统一上界时，Holm 家族错误率的渐近趋势。\n\n第三部分：球面样本与随机游走拉普拉斯构造\n3. 在维度 d = 10 的单位球面 S^9 上生成 n = 1000 个样本点，记为 X ∈ ℝ^{1000×10}，其前 10 个样本行向量为 x_1,…,x_{10}（具体坐标视为已知常量）。对这些点采用带宽 ε = 0.1 构造权重\n   - w_{ij} = exp( -‖x_i - x_j‖^2 / ε )，i ≠ j；\n   - w_{ii} = 0。\n   由此得到基于前 10 个样本点的度向量 d = (d_1,…,d_{10})，并构造对应的随机游走拉普拉斯子矩阵 L_rw^(10)。\n   (3.a) 写出：\n   - 利用给定样本点与权重 w_{ij} 构造 L_rw^(10) 的明确矩阵公式（包括 D、W、L_rw^(10) 各项）；\n   - 解释度向量分量 d_i 的含义及其与 w_{ij} 的关系；\n   - 说明随机游走拉普拉斯 L_rw^(10) 的特征值范围为何包含在一个固定区间内，并指出该区间。[仅需给出符号论证与区间表达式。]\n\n   (3.b) 假设对完整 n = 1000 的球面样本构造 L_rw，并按第二部分方法构造 Σ_new(1000)。结合第二部分结论，讨论在 n = 1000 以及更大 n 情形下，FWER_new(n, α) 随 n 的变化趋势。指出影响该趋势（特别是随 n 递减速度）的主要符号因素，例如 μ*，谱界 C_Σ，条件数界 K_0，模态数量 m(n) 以及 g(·) 的有界性等。结果以定性与符号关系表述，不需具体数值。\n\n第四部分：带宽选择与谱近似误差上界\n4. 对球面 S^9 上的图拉普拉斯谱估计，在不同样本数 n 下给出了经验最优带宽 ε(n) 及对应的谱近似经验误差与理论误差上界。设理论误差上界具有形式\n   - Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))，\n   其中 Bias(ε) 与 Variance(ε, n) 为非负函数，C > 0 为常数。在 n = 1000、ε = 0.4651471、d = 9 的情况下，给出：\n   - bias_term = 0.4651471；\n   - variance_term = 0.3172382；\n   - exponent = -1.75（为某中间标量参数，可视为已知常量，与本题仅作为背景）；\n   - constant_factor C = 10.0；\n   - 由此可得某具体数值 Bound(1000, 0.4651471)（以预设数值存在，考生无需复述该数值，只需通过符号运算说明其计算方式）。\n\n   (4.a) 假设谱近似误差直接影响协方差矩阵构造，使得实际用于检验的协方差为\n   - Σ_new,approx(n) = Σ_new,true(n) + E_n，\n   其中 ‖E_n‖_op ≤ Bound(n, ε(n))。在 Holm 检验下，讨论在 n = 1000 时，若给定 Bound(1000, ε(1000)) 为一已知常数，对 FWER_new(1000, α) 可能造成的影响。说明在何种一般条件下（例如：协方差到检验统计量分布的映射对谱扰动具某种 Lipschitz 稳健性，p 值分布对协方差变化连续等），可以保证该误差不会改变第二部分的渐近极限结论，只会影响有限样本下 FWER 的具体数值大小。结果以定性与符号不等式形式表述。\n\n   (4.b) 使用给定的 bias_term、variance_term 与常数 C，写出 Bound(1000, 0.4651471) 的计算表达式（不需化为具体数值），并说明当 n 增大，ε(n) 按某缩放条件（例如 ε(n)^{d/2+1} 与 (log n)/n 同阶）变化时，Bound(n, ε(n)) 随 n 的变化趋势（例如是否趋于 0 或有界）。结果以符号表达式与极限形式描述，不要求数值。\n\n第五部分：环面数据的错设建模与 Holm 家族错误率的稳健性\n5. 在三维空间中生成 1000 个三维环面样本点 {z_i}，实际位于半径参数为 (R, r) = (2.0, 0.5) 的环面上。现研究者错误地将这些数据视为球面样本，仍然使用球面构造的图拉普拉斯谱方法构造协方差矩阵 Σ_new^sphere(n)，并据此生成高斯向量并进行 Holm 多重检验，记对应家族错误率为 FWER_misspec(n, α)。\n   (5.a) 定性讨论这种模型错设对 FWER_new(n, α) 控制的潜在影响，主要从以下方面分析：\n        - 局部几何（曲率与维度）差异对权重 w_{ij} 及图结构的影响；\n        - 谱近似误差可能系统性偏大的情形对 Σ_new^sphere(n) 与真实相关结构差异的影响；\n        - 在 μ* 有界且 Σ_new^sphere(n) 的谱范数与条件数仍有统一上界的前提下，FWER_misspec(n, α) 的渐近极限与“正确模型”下的 FWER_correct(n, α) 之间的关系（例如是否仍趋于 0 或至多有一个可控偏移）。\n   要求给出定性说明与符号关系，不需数值。\n\n   (5.b) 提出一个合理的误差度量来刻画球面模型与环面真实模型之间的协方差偏差，例如以算子范数 ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op 或某种距离（如 Wasserstein 距离）记为 ε_spec(n)。在此基础上，说明如何在理论或数值上评估此误差对 Holm FWER 的影响，并给出一个可能的上界形式，例如\n        |FWER_misspec(n, α) - FWER_correct(n, α)| 与 ε_spec(n) 之间的关系，\n   要求给出符号上界形式（含某常数因子），并说明 ε_spec(n) 可以与 Bound(n, ε(n)) 同阶或同数量级。不得给出具体数值。\n\n第六部分：综合总结\n6. 对以上各部分进行总结，回答：\n   (6.a) 第一部分和第二部分中 Holm 家族错误率随 n 渐近趋于某极限（特别是趋于 0）的关键理论原因；\n   (6.b) 球面样本与图拉普拉斯谱如何用于构造协方差矩阵，并与简单等相关模型在依赖结构上的差异进行比较；\n   (6.c) Bound(1000, 0.4651471) 的一般推导形式与计算步骤（以符号表达式为主），以及如何利用给定的 bias_term、variance_term 与 C 进行验证；\n   (6.d) 给出经验误差与对应理论上界之间的关系及其与 n 增大时理论趋势的一致性说明（仅作趋势与相对大小分析，不需数值计算）；\n   (6.e) 在实际流形为环面但使用球面模型进行协方差构造的情况下，多重检验 FWER 控制的稳健性与可能偏差来源，并说明在何种条件下 FWER 控制仍然可靠（例如仍渐近趋于 0 或偏差可控）。\n\n所有结果除非题中已显式给定具体值，均以符号表达式、极限或不等式形式给出，不要求具体数值计算。\nYou should strictly respond in this exact format and answer the question in its original language:\nexample:###Answer###\n$\\boxed{}$"
    },
    {
      "role": "assistant",
      "content": "\n###Answer###\n$\\boxed{}$"
    },
    {
      "role": "user",
      "content": "现在请仅输出严格 JSON，必须完全匹配以下结构（键名、层级、字段齐全），所有数值用数字表示（保留2-3位小数），布尔用 true/false，字符串填写说明文字。不要输出任何解释文字或前后缀，也不要多余字段；若无法计算某值请给出可解析的近似值。\n\n{\n  \"(1.a)\": \"[数学方程字符串]\",\n  \"(2.a)\": \"[数学方程字符串]\",\n  \"(3.a)\": \"[数学方程字符串]\",\n  \"(3.b)\": \"[数学方程字符串]\",\n  \"(4.a)\": \"[数学方程字符串]\",\n  \"(4.b)\": \"[数学方程字符串]\",\n  \"(5.a)\": \"[数学方程字符串]\",\n  \"(5.b)\": \"[数学方程字符串]\",\n  \"(6.a)\": \"[数学方程字符串]\",\n  \"(6.b)\": \"[数学方程字符串]\",\n  \"(6.c)\": \"[数学方程字符串]\",\n  \"(6.d)\": \"[数学方程字符串]\",\n  \"(6.e)\": \"[数学方程字符串]\"\n}"
    },
    {
      "role": "assistant",
      "content": ""
    }
  ],
  "metadata": {
    "subject": "Statistics",
    "topic": "Statistical Analysis",
    "image_path": null,
    "solution_steps": [],
    "tool_expected": [
      "sample_sphere",
      "visualize_manifold_samples",
      "build_graph_laplacian_from_samples",
      "compute_laplacian_eigenpairs",
      "evaluate_sphere_eigenfunction",
      "compute_sampling_vector",
      "compute_alignment_sign",
      "compute_euclidean_error",
      "theoretical_error_bound",
      "visualize_eigenfunction_comparison",
      "analyze_bandwidth_scaling",
      "visualize_convergence_rate",
      "sample_torus"
    ],
    "golden_answer": [
      {
        "(1.a)": "在 μ* 有界、ρ ∈ (0,1]、α ∈ (0,1) 固定的条件下，对任意真/假原假设配置有\nlim_{n→∞} FWER_Holm(n, α, ρ) = 0。\n要点：\n- 利用等相关表示 X_i = √(1-ρ) Z_i + √ρ U，将条件于 U 的联合分布化为独立高斯和公共位移；\n- 在 μ* 有界下，条件于 U 的每个真原假设指标 X_i 的上尾概率在 n→∞ 时仍足够小；\n- Holm 步降阈值最小阶约为 α/n，因此在任意给定 U 下真原假设的同时小 p 值事件概率随 n 衰减；\n- 对 U 积分后得到统一上界，进而得出上述极限关系。",
        "(2.a)": "在假设 sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞、sup_n κ(Σ_new(n)) ≤ K_0 < ∞ 且 μ* 有界时，对任意固定 α ∈ (0,1) 有\nlim_{n→∞} FWER_new(n, α) = 0。\n要点：\n- 谱范数与条件数统一有界意味着各坐标的方差与两两相关系数均受控，不会随 n 爆炸或退化；\n- 可以找到与独立情形可比的子高斯尾界与联合尾界，从而对真原假设下最小 p 值给出随 n 收敛到 0 的上界；\n- 利用 Holm 步降阈值的 1/n 级缩小以及均值统一有界的假设，可将家族第一类错误率统一上界压缩到随 n → ∞ 而趋于 0；\n- 真/假原假设的配置只影响常数因子，不影响极限。",
        "(3.a)": "构造公式与解释：\n- 权重矩阵 W = (w_{ij})_{1≤i,j≤10}：\n  w_{ij} = exp( -‖x_i - x_j‖^2 / ε ), i ≠ j； w_{ii} = 0。\n- 度矩阵 D 为对角矩阵，(D)_{ii} = d_i，且\n  d_i = ∑_{j=1}^{10} w_{ij}。\n- 随机游走拉普拉斯子矩阵\n  L_rw^(10) = I_{10} - D^{-1} W，\n  即 (L_rw^(10))_{ij} = δ_{ij} - w_{ij} / d_i。\n- 度向量分量 d_i 的含义：d_i 是结点 i 与所有其他结点之间权重之和，刻画了以高斯核为边权的加权度；\n- 光谱范围：矩阵 P := D^{-1} W 为行随机矩阵，谱半径不超过 1，且其所有特征值 λ(P) 满足 |λ(P)| ≤ 1。由于 L_rw^(10) = I_{10} - P，其特征值为 1 - λ(P)；因此 L_rw^(10) 的特征值 λ(L_rw^(10)) 满足\n  0 ≤ λ(L_rw^(10)) ≤ 2，\n  因而谱半径位于区间 [0, 2]。",
        "(3.b)": "对 n = 1000 及更大 n：\n- 由第二部分假设可视 Σ_new(n) 满足 sup_n ‖Σ_new(n)‖_op ≤ C_Σ、sup_n κ(Σ_new(n)) ≤ K_0，且 μ* 有界；\n- 依据 (2.a) 的结论形式，可认为 FWER_new(n, α) 随 n 单调下降或至少不增加，并满足\n  lim_{n→∞} FWER_new(n, α) = 0；\n- 对于固定 n = 1000，FWER_new(1000, α) 是上述极限行为下的有限样本值，其大小受以下因素主导：\n  1) μ* 越小，真原假设下统计量越集中在 0 附近，最小 p 值越大，FWER 越小；\n  2) C_Σ 越小、K_0 越接近 1，则相关结构相对“温和”，不会产生极端联合尾部依赖，从而加速 FWER 的递减；\n  3) 模态数量 m(n) 较小、g(·) 有界且变化平缓，有利于稳定协方差结构，避免高频噪声放大；\n- 因此可定性认为，在这些参数受控时，FWER_new(n, α) 随 n 增大递减，且递减速度由 μ*、C_Σ、K_0 及 m(n)、g(·) 的选取共同决定。",
        "(4.a)": "设 Σ_new,approx(n) = Σ_new,true(n) + E_n 且 ‖E_n‖_op ≤ Bound(n, ε(n))。在 n = 1000 时记 B_1000 := Bound(1000, ε(1000)) 为给定常数。\n要点：\n- 在高斯模型下，协方差矩阵的扰动 E_n 的算子范数控制了联合分布在某距离度量（例如 Wasserstein 距离或总变差的上界）中的偏差：存在常数 C_1，使得\n  dist_law(Y_true, Y_approx) ≤ C_1 ‖E_n‖_op ≤ C_1 B_1000；\n- 若从协方差到 p 值向量分布的映射在该距离下是 Lipschitz 连续的，则存在常数 C_2，使\n  dist_law(p_true, p_approx) ≤ C_2 B_1000；\n- Holm 程序的拒绝事件指标是 p 值向量的可测函数，若其对应概率函数对分布扰动也满足某种连续性（例如概率函数对分布距离 Lipschitz），则存在常数 C_3，使得\n  |FWER_new,approx(1000, α) - FWER_new,true(1000, α)| ≤ C_3 B_1000；\n- 对于一般 n，有\n  |FWER_new,approx(n, α) - FWER_new,true(n, α)| ≤ C_3 Bound(n, ε(n))；\n- 若 Bound(n, ε(n)) 随 n 有界或趋于 0，则第二部分的极限结论 lim_{n→∞} FWER_new,true(n, α) = 0 仍然成立；近似误差只影响有限 n 下的 FWER 数值大小，而不改变 n → ∞ 时的极限。",
        "(4.b)": "理论上界的符号计算：\n- 由给定形式，有\n  Bound(1000, 0.4651471) = C · (Bias(0.4651471) + Variance(0.4651471, 1000))。\n- 题中给出 bias_term 与 variance_term 为 Bias(0.4651471) 与 Variance(0.4651471, 1000) 的具体值记为 b 与 v，则\n  Bound(1000, 0.4651471) = C · (b + v)，\n  其中 C = 10，b = bias_term，v = variance_term。\n- 因此计算步骤为：先将 b 与 v 相加，再乘以常数 C，即\n  Bound(1000, 0.4651471) = 10 · (bias_term + variance_term)。\n\n关于 n → ∞ 时的缩放：\n- 若 ε(n) 按某条件缩放，例如存在常数 c > 0 使\n  ε(n)^{d/2+1} ≍ (log n)/n，\n  则通常可以得到 Bias(ε(n)) 与 Variance(ε(n), n) 的相反趋势：\n  1) Bias(ε(n)) 随 ε(n) → 0 而减小，一般可写为 Bias(ε(n)) = O(ε(n)^β) 对某 β > 0；\n  2) Variance(ε(n), n) 随 n 增大而下降，一般可写为 Variance(ε(n), n) = O((n ε(n)^{d/2+1})^{-γ}) 对某 γ > 0；\n- 以上缩放条件通常是通过平衡 Bias 与 Variance 的阶数来确定，使得 Bias(ε(n)) 与 Variance(ε(n), n) 具有相近的衰减速率；\n- 因此\n  Bound(n, ε(n)) = C · (Bias(ε(n)) + Variance(ε(n), n))\n  要么随 n → ∞ 而趋于 0，要么在某些边界情形下保持有界，不会随 n 爆炸；\n- 这保证了谱近似误差对协方差构造的影响在大样本下是可控的，从而不会破坏第二部分中关于 FWER 渐近行为的结论。",
        "(5.a)": "定性影响分析：\n- 局部几何差异：环面与球面在曲率和局部维度结构上不同，导致使用球面几何假设构造的邻接权重 w_{ij} 会系统偏离真实几何诱导的权重，表现为边权分布与连通结构的偏差；\n- 谱近似误差：由于基础流形不同，球面图拉普拉斯谱与真实环面拉普拉斯谱之间存在结构性差异，会使得 Σ_new^sphere(n) 与真实协方差 Σ_true^torus(n) 存在系统性误差，记为 E_spec(n)；该误差可能不再均值为 0，而是带有几何错设引起的偏向；\n- 对相关结构的影响：上述误差体现在相关结构上意味着坐标间的真实依赖与模型中的依赖会不同，这会改变检验统计量联合分布与极端事件的概率，从而使 FWER_misspec(n, α) 与 FWER_correct(n, α) 产生偏差；\n- 渐近行为：若尽管错设存在，但仍有\n  sup_n ‖Σ_new^sphere(n)‖_op ≤ C_Σ^sphere < ∞，sup_n κ(Σ_new^sphere(n)) ≤ K_0^sphere < ∞，\n  且 μ* 有界，则可沿用第二部分的思路，对错设模型本身的 FWER_misspec(n, α) 建立与 n 相关的上界，并得到\n  lim_{n→∞} FWER_misspec(n, α) = 0，\n  或者在更弱条件下，至少有 limsup_{n→∞} FWER_misspec(n, α) ≤ δ，对某小常数 δ ≥ 0；\n- 因此，几何错设主要影响有限样本下的 FWER 数值大小和收敛速度，但在协方差谱与条件数受控的前提下，不必然破坏 FWER 渐近趋于 0 的性质。",
        "(5.b)": "误差度量与 FWER 偏差上界：\n- 选取误差度量：可定义\n  ε_spec(n) := ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op，\n  或者选用相应高斯分布之间的 Wasserstein 距离 W_2，二者在高斯情形下由协方差差异联系；比如存在常数 C_4，使\n  W_2( N(μ, Σ_true^torus(n)), N(μ, Σ_new^sphere(n)) ) ≤ C_4 ε_spec(n)。\n- 分布扰动到 FWER 的影响：若从协方差到 p 值向量分布的映射在所选距离下是 Lipschitz 的，则存在常数 C_5，使\n  dist_law(p_correct, p_misspec) ≤ C_5 ε_spec(n)；\n- Holm 程序的 FWER 是 p 值分布下某拒绝事件的概率，因此如果此概率函数对分布距离也具 Lipschitz 性，则存在 C_6，使\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C_6 ε_spec(n)。\n- 若进一步将 ε_spec(n) 与上文 Bound(n, ε(n)) 建立关系，例如有\n  ε_spec(n) ≤ C_7 Bound(n, ε(n))，\n  则可得到组合上界\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' Bound(n, ε(n))，\n  其中 C' = C_6 C_7。\n- 当 Bound(n, ε(n)) 随 n 有界或趋于 0 时，错设模型与正确模型下 FWER 之间的偏差保持可控，甚至随 n 收缩。",
        "(6.a)": "Holm FWER 渐近趋于 0 的关键原因：\n- 关键是阈值序列 u_k = α/(n-k+1) 随 n 增大而整体下降，尤其是最小阈值与 1/n 同阶，使得在真原假设下出现极小 p 值的概率可被强力压缩；\n- 均值统一有界（μ* 有界）确保真原假设下统计量的上尾不会因均值漂移而恶化；\n- 协方差矩阵谱范数与条件数统一有界，保证依赖结构不会产生随 n 爆炸的集体极端事件概率；\n- 综上，可对最小 p 值的分布给出随 n 收缩的上界，进而得到 FWER 的统一上界随 n → ∞ 而趋于 0。",
        "(6.b)": "球面样本与图拉普拉斯谱构造协方差的方式及与等相关模型差异：\n- 对球面样本 {x_i}，通过高斯核构造权重 W，再由 D 与 L_rw = I - D^{-1} W 得到图拉普拉斯；\n- 对 L_rw 进行谱分解，选取若干前导特征对 {λ_k, u_k}，通过核 g(λ_k) 线性组合 u_k u_k^T 得到低维谱核 K；\n- 协方差矩阵设为 Σ_new(n) = K + τ^2 I_n，从而将流形几何（通过图结构与谱）编码到相关结构中；\n- 与等相关模型相比：\n  1) 等相关模型中所有非对角相关系数相同，结构高度同质；\n  2) 图拉普拉斯谱协方差则反映局部邻接关系与几何结构，不同结点间相关性取决于图上的距离与谱模态；\n  3) 这使得依赖结构更为异质与局部化，但在谱界与条件数受控下，其对 Holm FWER 的渐近影响可与等相关情形类似处理。",
        "(6.c)": "Bound(1000, 0.4651471) 的推导与验证：\n- 给定一般公式 Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))；\n- 在 n = 1000、ε = 0.4651471、d = 9 时，记 Bias(ε) = bias_term，Variance(ε, n) = variance_term，常数 C 已知；\n- 则符号上\n  Bound(1000, 0.4651471) = C · (bias_term + variance_term)；\n- 验证步骤：\n  1) 将 bias_term 与 variance_term 相加；\n  2) 用常数 C 乘上述和，即得到 Bound(1000, 0.4651471)；\n- 通过该步骤可核对给定数值是否符合上述表达式，确保理论公式与数值实现一致。",
        "(6.d)": "经验误差与理论上界及其趋势的一致性：\n- 在各个 n（例如 n = 100, 500, 1000）下的经验误差均小于对应的理论上界 Bound(n, ε(n))，体现了上界的保守性；\n- 随 n 增大，通过适当缩放 ε(n)，理论上 Bias(ε(n)) 与 Variance(ε(n), n) 合理平衡，使 Bound(n, ε(n)) 随 n 减小或保持有界；\n- 经验误差的变化趋势通常与 Bound(n, ε(n)) 的趋势类似：\n  1) 经验误差随着 n 增大可能略有波动，但整体不爆炸；\n  2) 理论上界一般随 n 增长而逐步减小或趋于某有限常数；\n- 因此，经验误差与理论上界之间的相对关系以及随 n 的趋势总体上与理论预期一致：理论上界提供一个统一的安全阈值，而实际误差位于此阈值之下并呈随 n 改善的趋势。",
        "(6.e)": "球面模型用于环面数据时的稳健性与偏差来源：\n- 偏差来源：\n  1) 几何错设导致基于球面假设构造的权重与真实环面结构不匹配，引入系统性谱误差；\n  2) 该谱误差通过协方差矩阵 Σ_new^sphere(n) 体现为对真实相关结构的偏离；\n  3) 进一步影响 p 值的联合分布，从而偏移 FWER；\n- 稳健性条件：\n  1) 若错设后的协方差矩阵 Σ_new^sphere(n) 在谱范数与条件数上仍有统一上界，且均值 μ* 有界，则可以类比第二部分结果，在错设模型下仍建立\n     lim_{n→∞} FWER_misspec(n, α) = 0\n     或 limsup_{n→∞} FWER_misspec(n, α) ≤ δ（δ 小）这样的结论；\n  2) 若协方差偏差 ε_spec(n) 随 n 有界或趋于 0，则利用 Lipschitz 型上界可以保证\n     |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' ε_spec(n)，\n     因而偏差可控；\n- 综合来看，只要错设后的协方差族不出现高维爆炸或高度退化，且几何错设造成的谱偏差有限，多重检验的 FWER 控制在大样本下仍然可靠，主要风险集中在有限样本中 FWER 的轻微偏高或偏低，需要通过模拟或额外保守修正加以校正。"
      }
    ],
    "original_question_id": "36",
    "test_type": "refined",
    "dataset_key": "merged_questions_augmented",
    "trace_root": "/Users/yangyajie/Desktop/code/Toolkit/tracetoanalyze/traces",
    "_dataset_filename": "refine_merged_single_questions.json"
  },
  "metadata_summary": {
    "subject": "Statistics",
    "topic": "Statistical Analysis",
    "test_type": "refined",
    "original_question_id": "36",
    "subject_topic_key": "Statistics::Statistical Analysis"
  },
  "answer_template": {
    "(1.a)": "[数学方程字符串]",
    "(2.a)": "[数学方程字符串]",
    "(3.a)": "[数学方程字符串]",
    "(3.b)": "[数学方程字符串]",
    "(4.a)": "[数学方程字符串]",
    "(4.b)": "[数学方程字符串]",
    "(5.a)": "[数学方程字符串]",
    "(5.b)": "[数学方程字符串]",
    "(6.a)": "[数学方程字符串]",
    "(6.b)": "[数学方程字符串]",
    "(6.c)": "[数学方程字符串]",
    "(6.d)": "[数学方程字符串]",
    "(6.e)": "[数学方程字符串]"
  },
  "golden_standard": {
    "(1.a)": "在 μ* 有界、ρ ∈ (0,1]、α ∈ (0,1) 固定的条件下，对任意真/假原假设配置有\nlim_{n→∞} FWER_Holm(n, α, ρ) = 0。\n要点：\n- 利用等相关表示 X_i = √(1-ρ) Z_i + √ρ U，将条件于 U 的联合分布化为独立高斯和公共位移；\n- 在 μ* 有界下，条件于 U 的每个真原假设指标 X_i 的上尾概率在 n→∞ 时仍足够小；\n- Holm 步降阈值最小阶约为 α/n，因此在任意给定 U 下真原假设的同时小 p 值事件概率随 n 衰减；\n- 对 U 积分后得到统一上界，进而得出上述极限关系。",
    "(2.a)": "在假设 sup_n ‖Σ_new(n)‖_op ≤ C_Σ < ∞、sup_n κ(Σ_new(n)) ≤ K_0 < ∞ 且 μ* 有界时，对任意固定 α ∈ (0,1) 有\nlim_{n→∞} FWER_new(n, α) = 0。\n要点：\n- 谱范数与条件数统一有界意味着各坐标的方差与两两相关系数均受控，不会随 n 爆炸或退化；\n- 可以找到与独立情形可比的子高斯尾界与联合尾界，从而对真原假设下最小 p 值给出随 n 收敛到 0 的上界；\n- 利用 Holm 步降阈值的 1/n 级缩小以及均值统一有界的假设，可将家族第一类错误率统一上界压缩到随 n → ∞ 而趋于 0；\n- 真/假原假设的配置只影响常数因子，不影响极限。",
    "(3.a)": "构造公式与解释：\n- 权重矩阵 W = (w_{ij})_{1≤i,j≤10}：\n  w_{ij} = exp( -‖x_i - x_j‖^2 / ε ), i ≠ j； w_{ii} = 0。\n- 度矩阵 D 为对角矩阵，(D)_{ii} = d_i，且\n  d_i = ∑_{j=1}^{10} w_{ij}。\n- 随机游走拉普拉斯子矩阵\n  L_rw^(10) = I_{10} - D^{-1} W，\n  即 (L_rw^(10))_{ij} = δ_{ij} - w_{ij} / d_i。\n- 度向量分量 d_i 的含义：d_i 是结点 i 与所有其他结点之间权重之和，刻画了以高斯核为边权的加权度；\n- 光谱范围：矩阵 P := D^{-1} W 为行随机矩阵，谱半径不超过 1，且其所有特征值 λ(P) 满足 |λ(P)| ≤ 1。由于 L_rw^(10) = I_{10} - P，其特征值为 1 - λ(P)；因此 L_rw^(10) 的特征值 λ(L_rw^(10)) 满足\n  0 ≤ λ(L_rw^(10)) ≤ 2，\n  因而谱半径位于区间 [0, 2]。",
    "(3.b)": "对 n = 1000 及更大 n：\n- 由第二部分假设可视 Σ_new(n) 满足 sup_n ‖Σ_new(n)‖_op ≤ C_Σ、sup_n κ(Σ_new(n)) ≤ K_0，且 μ* 有界；\n- 依据 (2.a) 的结论形式，可认为 FWER_new(n, α) 随 n 单调下降或至少不增加，并满足\n  lim_{n→∞} FWER_new(n, α) = 0；\n- 对于固定 n = 1000，FWER_new(1000, α) 是上述极限行为下的有限样本值，其大小受以下因素主导：\n  1) μ* 越小，真原假设下统计量越集中在 0 附近，最小 p 值越大，FWER 越小；\n  2) C_Σ 越小、K_0 越接近 1，则相关结构相对“温和”，不会产生极端联合尾部依赖，从而加速 FWER 的递减；\n  3) 模态数量 m(n) 较小、g(·) 有界且变化平缓，有利于稳定协方差结构，避免高频噪声放大；\n- 因此可定性认为，在这些参数受控时，FWER_new(n, α) 随 n 增大递减，且递减速度由 μ*、C_Σ、K_0 及 m(n)、g(·) 的选取共同决定。",
    "(4.a)": "设 Σ_new,approx(n) = Σ_new,true(n) + E_n 且 ‖E_n‖_op ≤ Bound(n, ε(n))。在 n = 1000 时记 B_1000 := Bound(1000, ε(1000)) 为给定常数。\n要点：\n- 在高斯模型下，协方差矩阵的扰动 E_n 的算子范数控制了联合分布在某距离度量（例如 Wasserstein 距离或总变差的上界）中的偏差：存在常数 C_1，使得\n  dist_law(Y_true, Y_approx) ≤ C_1 ‖E_n‖_op ≤ C_1 B_1000；\n- 若从协方差到 p 值向量分布的映射在该距离下是 Lipschitz 连续的，则存在常数 C_2，使\n  dist_law(p_true, p_approx) ≤ C_2 B_1000；\n- Holm 程序的拒绝事件指标是 p 值向量的可测函数，若其对应概率函数对分布扰动也满足某种连续性（例如概率函数对分布距离 Lipschitz），则存在常数 C_3，使得\n  |FWER_new,approx(1000, α) - FWER_new,true(1000, α)| ≤ C_3 B_1000；\n- 对于一般 n，有\n  |FWER_new,approx(n, α) - FWER_new,true(n, α)| ≤ C_3 Bound(n, ε(n))；\n- 若 Bound(n, ε(n)) 随 n 有界或趋于 0，则第二部分的极限结论 lim_{n→∞} FWER_new,true(n, α) = 0 仍然成立；近似误差只影响有限 n 下的 FWER 数值大小，而不改变 n → ∞ 时的极限。",
    "(4.b)": "理论上界的符号计算：\n- 由给定形式，有\n  Bound(1000, 0.4651471) = C · (Bias(0.4651471) + Variance(0.4651471, 1000))。\n- 题中给出 bias_term 与 variance_term 为 Bias(0.4651471) 与 Variance(0.4651471, 1000) 的具体值记为 b 与 v，则\n  Bound(1000, 0.4651471) = C · (b + v)，\n  其中 C = 10，b = bias_term，v = variance_term。\n- 因此计算步骤为：先将 b 与 v 相加，再乘以常数 C，即\n  Bound(1000, 0.4651471) = 10 · (bias_term + variance_term)。\n\n关于 n → ∞ 时的缩放：\n- 若 ε(n) 按某条件缩放，例如存在常数 c > 0 使\n  ε(n)^{d/2+1} ≍ (log n)/n，\n  则通常可以得到 Bias(ε(n)) 与 Variance(ε(n), n) 的相反趋势：\n  1) Bias(ε(n)) 随 ε(n) → 0 而减小，一般可写为 Bias(ε(n)) = O(ε(n)^β) 对某 β > 0；\n  2) Variance(ε(n), n) 随 n 增大而下降，一般可写为 Variance(ε(n), n) = O((n ε(n)^{d/2+1})^{-γ}) 对某 γ > 0；\n- 以上缩放条件通常是通过平衡 Bias 与 Variance 的阶数来确定，使得 Bias(ε(n)) 与 Variance(ε(n), n) 具有相近的衰减速率；\n- 因此\n  Bound(n, ε(n)) = C · (Bias(ε(n)) + Variance(ε(n), n))\n  要么随 n → ∞ 而趋于 0，要么在某些边界情形下保持有界，不会随 n 爆炸；\n- 这保证了谱近似误差对协方差构造的影响在大样本下是可控的，从而不会破坏第二部分中关于 FWER 渐近行为的结论。",
    "(5.a)": "定性影响分析：\n- 局部几何差异：环面与球面在曲率和局部维度结构上不同，导致使用球面几何假设构造的邻接权重 w_{ij} 会系统偏离真实几何诱导的权重，表现为边权分布与连通结构的偏差；\n- 谱近似误差：由于基础流形不同，球面图拉普拉斯谱与真实环面拉普拉斯谱之间存在结构性差异，会使得 Σ_new^sphere(n) 与真实协方差 Σ_true^torus(n) 存在系统性误差，记为 E_spec(n)；该误差可能不再均值为 0，而是带有几何错设引起的偏向；\n- 对相关结构的影响：上述误差体现在相关结构上意味着坐标间的真实依赖与模型中的依赖会不同，这会改变检验统计量联合分布与极端事件的概率，从而使 FWER_misspec(n, α) 与 FWER_correct(n, α) 产生偏差；\n- 渐近行为：若尽管错设存在，但仍有\n  sup_n ‖Σ_new^sphere(n)‖_op ≤ C_Σ^sphere < ∞，sup_n κ(Σ_new^sphere(n)) ≤ K_0^sphere < ∞，\n  且 μ* 有界，则可沿用第二部分的思路，对错设模型本身的 FWER_misspec(n, α) 建立与 n 相关的上界，并得到\n  lim_{n→∞} FWER_misspec(n, α) = 0，\n  或者在更弱条件下，至少有 limsup_{n→∞} FWER_misspec(n, α) ≤ δ，对某小常数 δ ≥ 0；\n- 因此，几何错设主要影响有限样本下的 FWER 数值大小和收敛速度，但在协方差谱与条件数受控的前提下，不必然破坏 FWER 渐近趋于 0 的性质。",
    "(5.b)": "误差度量与 FWER 偏差上界：\n- 选取误差度量：可定义\n  ε_spec(n) := ‖Σ_true^torus(n) - Σ_new^sphere(n)‖_op，\n  或者选用相应高斯分布之间的 Wasserstein 距离 W_2，二者在高斯情形下由协方差差异联系；比如存在常数 C_4，使\n  W_2( N(μ, Σ_true^torus(n)), N(μ, Σ_new^sphere(n)) ) ≤ C_4 ε_spec(n)。\n- 分布扰动到 FWER 的影响：若从协方差到 p 值向量分布的映射在所选距离下是 Lipschitz 的，则存在常数 C_5，使\n  dist_law(p_correct, p_misspec) ≤ C_5 ε_spec(n)；\n- Holm 程序的 FWER 是 p 值分布下某拒绝事件的概率，因此如果此概率函数对分布距离也具 Lipschitz 性，则存在 C_6，使\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C_6 ε_spec(n)。\n- 若进一步将 ε_spec(n) 与上文 Bound(n, ε(n)) 建立关系，例如有\n  ε_spec(n) ≤ C_7 Bound(n, ε(n))，\n  则可得到组合上界\n  |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' Bound(n, ε(n))，\n  其中 C' = C_6 C_7。\n- 当 Bound(n, ε(n)) 随 n 有界或趋于 0 时，错设模型与正确模型下 FWER 之间的偏差保持可控，甚至随 n 收缩。",
    "(6.a)": "Holm FWER 渐近趋于 0 的关键原因：\n- 关键是阈值序列 u_k = α/(n-k+1) 随 n 增大而整体下降，尤其是最小阈值与 1/n 同阶，使得在真原假设下出现极小 p 值的概率可被强力压缩；\n- 均值统一有界（μ* 有界）确保真原假设下统计量的上尾不会因均值漂移而恶化；\n- 协方差矩阵谱范数与条件数统一有界，保证依赖结构不会产生随 n 爆炸的集体极端事件概率；\n- 综上，可对最小 p 值的分布给出随 n 收缩的上界，进而得到 FWER 的统一上界随 n → ∞ 而趋于 0。",
    "(6.b)": "球面样本与图拉普拉斯谱构造协方差的方式及与等相关模型差异：\n- 对球面样本 {x_i}，通过高斯核构造权重 W，再由 D 与 L_rw = I - D^{-1} W 得到图拉普拉斯；\n- 对 L_rw 进行谱分解，选取若干前导特征对 {λ_k, u_k}，通过核 g(λ_k) 线性组合 u_k u_k^T 得到低维谱核 K；\n- 协方差矩阵设为 Σ_new(n) = K + τ^2 I_n，从而将流形几何（通过图结构与谱）编码到相关结构中；\n- 与等相关模型相比：\n  1) 等相关模型中所有非对角相关系数相同，结构高度同质；\n  2) 图拉普拉斯谱协方差则反映局部邻接关系与几何结构，不同结点间相关性取决于图上的距离与谱模态；\n  3) 这使得依赖结构更为异质与局部化，但在谱界与条件数受控下，其对 Holm FWER 的渐近影响可与等相关情形类似处理。",
    "(6.c)": "Bound(1000, 0.4651471) 的推导与验证：\n- 给定一般公式 Bound(n, ε) = C · (Bias(ε) + Variance(ε, n))；\n- 在 n = 1000、ε = 0.4651471、d = 9 时，记 Bias(ε) = bias_term，Variance(ε, n) = variance_term，常数 C 已知；\n- 则符号上\n  Bound(1000, 0.4651471) = C · (bias_term + variance_term)；\n- 验证步骤：\n  1) 将 bias_term 与 variance_term 相加；\n  2) 用常数 C 乘上述和，即得到 Bound(1000, 0.4651471)；\n- 通过该步骤可核对给定数值是否符合上述表达式，确保理论公式与数值实现一致。",
    "(6.d)": "经验误差与理论上界及其趋势的一致性：\n- 在各个 n（例如 n = 100, 500, 1000）下的经验误差均小于对应的理论上界 Bound(n, ε(n))，体现了上界的保守性；\n- 随 n 增大，通过适当缩放 ε(n)，理论上 Bias(ε(n)) 与 Variance(ε(n), n) 合理平衡，使 Bound(n, ε(n)) 随 n 减小或保持有界；\n- 经验误差的变化趋势通常与 Bound(n, ε(n)) 的趋势类似：\n  1) 经验误差随着 n 增大可能略有波动，但整体不爆炸；\n  2) 理论上界一般随 n 增长而逐步减小或趋于某有限常数；\n- 因此，经验误差与理论上界之间的相对关系以及随 n 的趋势总体上与理论预期一致：理论上界提供一个统一的安全阈值，而实际误差位于此阈值之下并呈随 n 改善的趋势。",
    "(6.e)": "球面模型用于环面数据时的稳健性与偏差来源：\n- 偏差来源：\n  1) 几何错设导致基于球面假设构造的权重与真实环面结构不匹配，引入系统性谱误差；\n  2) 该谱误差通过协方差矩阵 Σ_new^sphere(n) 体现为对真实相关结构的偏离；\n  3) 进一步影响 p 值的联合分布，从而偏移 FWER；\n- 稳健性条件：\n  1) 若错设后的协方差矩阵 Σ_new^sphere(n) 在谱范数与条件数上仍有统一上界，且均值 μ* 有界，则可以类比第二部分结果，在错设模型下仍建立\n     lim_{n→∞} FWER_misspec(n, α) = 0\n     或 limsup_{n→∞} FWER_misspec(n, α) ≤ δ（δ 小）这样的结论；\n  2) 若协方差偏差 ε_spec(n) 随 n 有界或趋于 0，则利用 Lipschitz 型上界可以保证\n     |FWER_misspec(n, α) - FWER_correct(n, α)| ≤ C' ε_spec(n)，\n     因而偏差可控；\n- 综合来看，只要错设后的协方差族不出现高维爆炸或高度退化，且几何错设造成的谱偏差有限，多重检验的 FWER 控制在大样本下仍然可靠，主要风险集中在有限样本中 FWER 的轻微偏高或偏低，需要通过模拟或额外保守修正加以校正。"
  },
  "expected_format": "structured_json",
  "answer_extraction_success": false,
  "model_raw_answer": "模型回答为空",
  "model_last_assistant_message": {
    "role": "assistant",
    "content": ""
  },
  "mode_folder": "with_tools_react"
}